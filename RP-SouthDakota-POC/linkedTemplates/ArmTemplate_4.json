{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "RP-SouthDakota-POC"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/df_DimPlaceHolder')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Final df POCs"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "reportingSalesOrderHeader",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Dummy",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [],
					"scriptLines": [
						"source(output(",
						"          SalesOrderID as integer,",
						"          RevisionNumber as integer,",
						"          OrderDate as timestamp,",
						"          DueDate as timestamp,",
						"          ShipDate as timestamp,",
						"          Status as integer,",
						"          OnlineOrderFlag as boolean,",
						"          SalesOrderNumber as string,",
						"          PurchaseOrderNumber as string,",
						"          AccountNumber as string,",
						"          CustomerID as integer,",
						"          ShipToAddressID as integer,",
						"          BillToAddressID as integer,",
						"          ShipMethod as string,",
						"          CreditCardApprovalCode as string,",
						"          SubTotal as decimal(19,4),",
						"          TaxAmt as decimal(19,4),",
						"          Freight as decimal(19,4),",
						"          TotalDue as decimal(19,4),",
						"          Comment as string,",
						"          rowguid as string,",
						"          ModifiedDate as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source1",
						"source1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          Column_1 as string",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> sink1"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/df_DimProgram')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Medical Assistance Program",
				"folder": {
					"name": "Dimensions"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "vwCodeTable",
								"type": "DatasetReference"
							},
							"name": "vwCodeTable"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "DimensionTargetTesting",
								"type": "DatasetReference"
							},
							"name": "tgtDimProgram"
						}
					],
					"transformations": [
						{
							"name": "ProgramType"
						},
						{
							"name": "drvTrimColumns"
						},
						{
							"name": "SelectTrimColumns"
						},
						{
							"name": "drvNullColumns"
						},
						{
							"name": "SelectTgtColumns"
						}
					],
					"scriptLines": [
						"source(output(",
						"          TABLENAME as string,",
						"          CODE as string,",
						"          DESCRIPTION as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> vwCodeTable",
						"vwCodeTable filter(TABLENAME=='ProgramType') ~> ProgramType",
						"ProgramType derive(ModifiedDate = currentUTC(),",
						"          each(match(type=='string'), $$+'_Trim' = trim($$))) ~> drvTrimColumns",
						"drvTrimColumns select(mapColumn(",
						"          ModifiedDate,",
						"          ProgramTypeCode = CODE_Trim,",
						"          ProgramType = DESCRIPTION_Trim",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectTrimColumns",
						"SelectTrimColumns derive(each(match(type=='string'), $$+'_null' = iifNull($$,'NA'))) ~> drvNullColumns",
						"drvNullColumns select(mapColumn(",
						"          ModifiedDate,",
						"          ProgramTypeCode = ProgramTypeCode_null,",
						"          ProgramType = ProgramType_null",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectTgtColumns",
						"SelectTgtColumns sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          Column_1 as string,",
						"          Column_2 as string,",
						"          Column_3 as string,",
						"          Column_4 as string,",
						"          Column_5 as string,",
						"          Column_6 as string",
						"     ),",
						"     partitionFileNames:['DimProgram.txt'],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> tgtDimProgram"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/df_DimRegion')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Region Dimension",
				"folder": {
					"name": "Dimensions"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Location",
								"type": "DatasetReference"
							},
							"name": "srcLocation"
						},
						{
							"dataset": {
								"referenceName": "SDRegion",
								"type": "DatasetReference"
							},
							"name": "srcSDRegion"
						},
						{
							"dataset": {
								"referenceName": "vwCodeTable",
								"type": "DatasetReference"
							},
							"name": "vwCodeTable"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "DimensionTargetTesting",
								"type": "DatasetReference"
							},
							"name": "tgtDimRegion"
						}
					],
					"transformations": [
						{
							"name": "LookupSDRegion"
						},
						{
							"name": "SelectRegion"
						},
						{
							"name": "LocationStatus"
						},
						{
							"name": "drvTrimColumns"
						},
						{
							"name": "LookupStatus"
						},
						{
							"name": "SelectTgtColumns"
						},
						{
							"name": "drvNullValues"
						},
						{
							"name": "SelectLookupStatus"
						},
						{
							"name": "SelectTrimColumns"
						}
					],
					"scriptLines": [
						"source(output(",
						"          LOCATIONID as long,",
						"          NAME as string,",
						"          ADDRESSID as long,",
						"          DESCRIPTION as string,",
						"          STATUSCODE as string,",
						"          LOCATIONSTATUS as string,",
						"          CREATIONDATE as date,",
						"          LOCATIONTYPE as string,",
						"          PARENTLOCATIONID as long,",
						"          ORGANISATIONID as long,",
						"          ADDRESSCOMMENTS as string,",
						"          CREATELOCATIONSID as string,",
						"          MAINTAINSID as string,",
						"          READSID as string,",
						"          LOCATIONSTRUCTUREID as long,",
						"          PUBLICOFFICEINDICATOR as string,",
						"          PHONENUMBERID as long,",
						"          FAXNUMBERID as long,",
						"          EMAILADDRESSID as long,",
						"          ROOTLOCATIONINDICATOR as string,",
						"          UPPERNAME as string,",
						"          VERSIONNO as integer,",
						"          LASTWRITTEN as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> srcLocation",
						"source(output(",
						"          SDREGIONID as long,",
						"          SDLOCATIONID as long,",
						"          SDREGIONNAME as string,",
						"          SDAPPLICATIONTYPE as string,",
						"          LASTWRITTEN as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> srcSDRegion",
						"source(output(",
						"          TABLENAME as string,",
						"          CODE as string,",
						"          DESCRIPTION as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> vwCodeTable",
						"srcSDRegion, srcLocation lookup(SDLOCATIONID == LOCATIONID,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LookupSDRegion",
						"LookupSDRegion select(mapColumn(",
						"          SDREGIONID,",
						"          SDLOCATIONID,",
						"          SDREGIONNAME,",
						"          SDAPPLICATIONTYPE,",
						"          LASTWRITTEN = srcSDRegion@LASTWRITTEN,",
						"          LOCATIONID,",
						"          NAME,",
						"          ADDRESSID,",
						"          DESCRIPTION,",
						"          STATUSCODE,",
						"          LOCATIONSTATUS,",
						"          CREATIONDATE,",
						"          LOCATIONTYPE,",
						"          PARENTLOCATIONID,",
						"          ORGANISATIONID,",
						"          ADDRESSCOMMENTS,",
						"          CREATELOCATIONSID,",
						"          MAINTAINSID,",
						"          READSID,",
						"          LOCATIONSTRUCTUREID,",
						"          PUBLICOFFICEINDICATOR,",
						"          PHONENUMBERID,",
						"          FAXNUMBERID,",
						"          EMAILADDRESSID,",
						"          ROOTLOCATIONINDICATOR,",
						"          UPPERNAME,",
						"          VERSIONNO,",
						"          LASTWRITTEN = srcLocation@LASTWRITTEN",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectRegion",
						"vwCodeTable filter(TABLENAME=='LocationStatus') ~> LocationStatus",
						"SelectRegion derive(each(match(type=='string'), $$+'_Trim' = trim($$))) ~> drvTrimColumns",
						"SelectTrimColumns, LocationStatus lookup(LOCATIONSTATUS_Trim == CODE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LookupStatus",
						"drvNullValues select(mapColumn(",
						"          RegionID = SDREGIONID,",
						"          ModifiedDate,",
						"          RegionName = SDREGIONNAME_Trim_null,",
						"          RegionStatus = RegionStatus_null",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectTgtColumns",
						"SelectLookupStatus derive(ModifiedDate = currentUTC(),",
						"          each(match(type=='string'), $$+'_null' = iifNull($$,'NA'))) ~> drvNullValues",
						"LookupStatus select(mapColumn(",
						"          SDREGIONID,",
						"          SDLOCATIONID,",
						"          LOCATIONID,",
						"          SDREGIONNAME_Trim,",
						"          RegionStatus = DESCRIPTION",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectLookupStatus",
						"drvTrimColumns select(mapColumn(",
						"          SDREGIONID,",
						"          SDLOCATIONID,",
						"          LOCATIONID,",
						"          SDREGIONNAME_Trim,",
						"          LOCATIONSTATUS_Trim",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectTrimColumns",
						"SelectTgtColumns sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          Column_1 as string,",
						"          Column_2 as string,",
						"          Column_3 as string,",
						"          Column_4 as string,",
						"          Column_5 as string,",
						"          Column_6 as string",
						"     ),",
						"     partitionFileNames:['DimRegion.txt'],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> tgtDimRegion"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/df_DimSanction')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Dimensions"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "vwCodeTable",
								"type": "DatasetReference"
							},
							"name": "vwCodeTable"
						},
						{
							"dataset": {
								"referenceName": "Sanction",
								"type": "DatasetReference"
							},
							"name": "srcSantion"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "DimensionTargetTesting",
								"type": "DatasetReference"
							},
							"name": "tgtDimSanction"
						}
					],
					"transformations": [
						{
							"name": "SanctionReason"
						},
						{
							"name": "SanctionLevel"
						},
						{
							"name": "RecordStatus"
						},
						{
							"name": "SanctionProgram"
						},
						{
							"name": "SelectSrcColumns"
						},
						{
							"name": "drvTrimFields"
						},
						{
							"name": "SelectTrimColumns"
						},
						{
							"name": "LookupProgram"
						},
						{
							"name": "SelectProgram"
						},
						{
							"name": "LookupRecordStatus"
						},
						{
							"name": "SelectRecordStatus"
						},
						{
							"name": "LookupLevel"
						},
						{
							"name": "SelectLevel"
						},
						{
							"name": "LookupReason"
						},
						{
							"name": "SelectReason"
						},
						{
							"name": "drvNullValues"
						},
						{
							"name": "SelectNullValues"
						}
					],
					"scriptLines": [
						"source(output(",
						"          TABLENAME as string,",
						"          CODE as string,",
						"          DESCRIPTION as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> vwCodeTable",
						"source(output(",
						"          SANCTIONID as long,",
						"          CONCERNROLEID as long,",
						"          SANCTIONREASON as string,",
						"          SANCTIONLEVEL as string,",
						"          SANCTIONSTARTDATE as timestamp,",
						"          SANCTIONENDDATE as timestamp,",
						"          COMMENTS as string,",
						"          STATUSCODE as string,",
						"          PROGRAM as string,",
						"          NUMBEROFMONTHS as integer,",
						"          CASEID as long,",
						"          NONCOMPLIANTCONCERNROLEID as long,",
						"          CONCILIATIONPROCIND as string,",
						"          CREATEDBY as string,",
						"          CREATEDON as timestamp,",
						"          VERSIONNO as integer,",
						"          LASTWRITTEN as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> srcSantion",
						"vwCodeTable filter(TABLENAME=='SanctionReason') ~> SanctionReason",
						"vwCodeTable filter(TABLENAME=='SanctionLevel') ~> SanctionLevel",
						"vwCodeTable filter(TABLENAME=='RecordStatus') ~> RecordStatus",
						"vwCodeTable filter(TABLENAME=='SanctionProgram') ~> SanctionProgram",
						"srcSantion select(mapColumn(",
						"          SANCTIONID,",
						"          CONCERNROLEID,",
						"          SANCTIONREASON,",
						"          SANCTIONLEVEL,",
						"          SANCTIONSTARTDATE,",
						"          SANCTIONENDDATE,",
						"          STATUSCODE,",
						"          PROGRAM,",
						"          SanctionConciliationFlag = CONCILIATIONPROCIND",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectSrcColumns",
						"SelectSrcColumns derive(each(match(type=='string'), $$+'_Trim' = trim($$))) ~> drvTrimFields",
						"drvTrimFields select(mapColumn(",
						"          SANCTIONID,",
						"          CONCERNROLEID,",
						"          SanctionConciliationFlag,",
						"          SANCTIONSTARTDATE,",
						"          SANCTIONENDDATE,",
						"          SANCTIONREASON_Trim,",
						"          SANCTIONLEVEL_Trim,",
						"          STATUSCODE_Trim,",
						"          PROGRAM_Trim",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectTrimColumns",
						"SelectTrimColumns, SanctionProgram lookup(PROGRAM_Trim == CODE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LookupProgram",
						"LookupProgram select(mapColumn(",
						"          SANCTIONID,",
						"          CONCERNROLEID,",
						"          SanctionConciliationFlag,",
						"          SANCTIONSTARTDATE,",
						"          SANCTIONENDDATE,",
						"          SANCTIONREASON_Trim,",
						"          SANCTIONLEVEL_Trim,",
						"          STATUSCODE_Trim,",
						"          SanctionProgramType = DESCRIPTION",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectProgram",
						"SelectProgram, RecordStatus lookup(STATUSCODE_Trim == CODE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LookupRecordStatus",
						"LookupRecordStatus select(mapColumn(",
						"          SANCTIONID,",
						"          CONCERNROLEID,",
						"          SanctionConciliationFlag,",
						"          SANCTIONSTARTDATE,",
						"          SANCTIONENDDATE,",
						"          SANCTIONREASON_Trim,",
						"          SANCTIONLEVEL_Trim,",
						"          STATUSCODE_Trim,",
						"          SanctionProgramType,",
						"          SanctionRecordStatus = DESCRIPTION",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectRecordStatus",
						"SelectRecordStatus, SanctionLevel lookup(SANCTIONLEVEL_Trim == CODE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LookupLevel",
						"LookupLevel select(mapColumn(",
						"          SANCTIONID,",
						"          CONCERNROLEID,",
						"          SanctionConciliationFlag,",
						"          SANCTIONSTARTDATE,",
						"          SANCTIONENDDATE,",
						"          SANCTIONREASON_Trim,",
						"          SANCTIONLEVEL_Trim,",
						"          STATUSCODE_Trim,",
						"          SanctionProgramType,",
						"          SanctionRecordStatus,",
						"          SanctionLevel = DESCRIPTION",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectLevel",
						"SelectLevel, SanctionReason lookup(SANCTIONREASON_Trim == CODE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LookupReason",
						"LookupReason select(mapColumn(",
						"          SANCTIONID,",
						"          CONCERNROLEID,",
						"          SanctionConciliationFlag,",
						"          SANCTIONSTARTDATE,",
						"          SANCTIONENDDATE,",
						"          SANCTIONREASON_Trim,",
						"          SANCTIONLEVEL_Trim,",
						"          STATUSCODE_Trim,",
						"          SanctionProgramType,",
						"          SanctionRecordStatus,",
						"          SanctionLevel,",
						"          SanctionReason = DESCRIPTION",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectReason",
						"SelectReason derive(ModifiedDate = currentUTC(),",
						"          each(match(type=='string'), $$+'_null' = iifNull($$,'NA'))) ~> drvNullValues",
						"drvNullValues select(mapColumn(",
						"          SanctionID = SANCTIONID,",
						"          ConcernRoleID = CONCERNROLEID,",
						"          SanctionConciliationFlag,",
						"          SanctionStartDate = SANCTIONSTARTDATE,",
						"          SanctionEndDate = SANCTIONENDDATE,",
						"          ModifiedDate,",
						"          SanctionProgramType = SanctionProgramType_null,",
						"          SanctionRecordStatus = SanctionRecordStatus_null,",
						"          SanctionLevel = SanctionLevel_null,",
						"          SanctionReason = SanctionReason_null",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectNullValues",
						"SelectNullValues sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          Column_1 as string,",
						"          Column_2 as string,",
						"          Column_3 as string,",
						"          Column_4 as string,",
						"          Column_5 as string,",
						"          Column_6 as string",
						"     ),",
						"     partitionFileNames:['DimSanction.txt'],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> tgtDimSanction"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/df_DimServiceSupplier')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Service Supplier Dim",
				"folder": {
					"name": "Dimensions"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "vwServiceSupplier",
								"type": "DatasetReference"
							},
							"name": "vwServiceSupplier"
						},
						{
							"dataset": {
								"referenceName": "vwCodeTable",
								"type": "DatasetReference"
							},
							"name": "vwCodeTable"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "DimensionTargetTesting",
								"type": "DatasetReference"
							},
							"name": "tgtDimServiceSupplier"
						}
					],
					"transformations": [
						{
							"name": "ServiceType"
						},
						{
							"name": "RecordStatus"
						},
						{
							"name": "LookupServiceType"
						},
						{
							"name": "SelectServiceType"
						},
						{
							"name": "LookupServiceSupplierStatus"
						},
						{
							"name": "SelectServiceSupplierStatus"
						},
						{
							"name": "LookupServiceTypeStatus"
						},
						{
							"name": "SelectServiceTypeStatus"
						},
						{
							"name": "drvNullValues"
						},
						{
							"name": "SelectTgtColumns"
						}
					],
					"scriptLines": [
						"source(output(",
						"          ConcernRoleID as long,",
						"          SERVICESUPPLIERNAME as string,",
						"          SERVICESUPPLIERSTATUSCODE as string,",
						"          SERVICESUPPLIERCREATIONDATE as timestamp,",
						"          SERVICETYPECODE as string,",
						"          SERVICESTATUSCODE as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> vwServiceSupplier",
						"source(output(",
						"          TABLENAME as string,",
						"          CODE as string,",
						"          DESCRIPTION as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> vwCodeTable",
						"vwCodeTable filter(TABLENAME== 'ServiceType') ~> ServiceType",
						"vwCodeTable filter(TABLENAME=='RecordStatus') ~> RecordStatus",
						"vwServiceSupplier, ServiceType lookup(SERVICETYPECODE == CODE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LookupServiceType",
						"LookupServiceType select(mapColumn(",
						"          ConcernRoleID,",
						"          SERVICESUPPLIERNAME,",
						"          SERVICESUPPLIERSTATUSCODE,",
						"          SERVICESUPPLIERCREATIONDATE,",
						"          SERVICESTATUSCODE,",
						"          ServiceSupplierServiceType = DESCRIPTION",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectServiceType",
						"SelectServiceType, RecordStatus lookup(SERVICESUPPLIERSTATUSCODE == CODE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LookupServiceSupplierStatus",
						"LookupServiceSupplierStatus select(mapColumn(",
						"          ConcernRoleID,",
						"          SERVICESUPPLIERNAME,",
						"          SERVICESUPPLIERCREATIONDATE,",
						"          SERVICESTATUSCODE,",
						"          ServiceSupplierServiceType,",
						"          ServiceSupplierStatus = DESCRIPTION",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectServiceSupplierStatus",
						"SelectServiceSupplierStatus, RecordStatus lookup(SERVICESTATUSCODE == CODE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LookupServiceTypeStatus",
						"LookupServiceTypeStatus select(mapColumn(",
						"          ConcernRoleID,",
						"          SERVICESUPPLIERNAME,",
						"          SERVICESUPPLIERCREATIONDATE,",
						"          ServiceSupplierServiceType,",
						"          ServiceSupplierStatus,",
						"          ServiceSupplierTypeStatus = DESCRIPTION",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectServiceTypeStatus",
						"SelectServiceTypeStatus derive(ModifiedDate = currentUTC(),",
						"          each(match(type=='string'), $$+'_null' = iifNull($$,'NA'))) ~> drvNullValues",
						"drvNullValues select(mapColumn(",
						"          ConcernRoleID,",
						"          ServiceSupplierCreationDate = SERVICESUPPLIERCREATIONDATE,",
						"          ModifiedDate,",
						"          ServiceSupplierName = SERVICESUPPLIERNAME_null,",
						"          ServiceSupplierServiceType = ServiceSupplierServiceType_null,",
						"          ServiceSupplierStatus = ServiceSupplierStatus_null,",
						"          ServiceSupplierTypeStatus = ServiceSupplierTypeStatus_null",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectTgtColumns",
						"SelectTgtColumns sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          Column_1 as string,",
						"          Column_2 as string,",
						"          Column_3 as string,",
						"          Column_4 as string,",
						"          Column_5 as string,",
						"          Column_6 as string",
						"     ),",
						"     partitionFileNames:['DimServiceSupplier'],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> tgtDimServiceSupplier"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/df_DimSuspension')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Dimensions"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "CodeTableItem",
								"type": "DatasetReference"
							},
							"name": "vwCodeTables"
						},
						{
							"dataset": {
								"referenceName": "SDSuspension",
								"type": "DatasetReference"
							},
							"name": "srcSuspension"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "DimensionTargetTesting",
								"type": "DatasetReference"
							},
							"name": "tgtDimSuspension"
						}
					],
					"transformations": [
						{
							"name": "POIProgram"
						},
						{
							"name": "SelectSrcColumns"
						},
						{
							"name": "LookupReason"
						},
						{
							"name": "SelectReason"
						},
						{
							"name": "LookupProgram"
						},
						{
							"name": "SelectProgram"
						},
						{
							"name": "SDSuspensionReason"
						},
						{
							"name": "drvTrimColumns"
						},
						{
							"name": "SelectDrvColumns"
						},
						{
							"name": "drvNullValues"
						},
						{
							"name": "SelectNullColumns"
						}
					],
					"scriptLines": [
						"source(output(",
						"          TABLENAME as string,",
						"          CODE as string,",
						"          DESCRIPTION as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> vwCodeTables",
						"source(output(",
						"          SDSUSPENSIONID as long,",
						"          COMMENTS as string,",
						"          CONCERNROLEID as long,",
						"          CREATEDBY as string,",
						"          ENDDATE as date,",
						"          STARTDATE as date,",
						"          STATUSCODE as string,",
						"          REASON as string,",
						"          PROGRAM as string,",
						"          CASEID as long,",
						"          LASTWRITTEN as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> srcSuspension",
						"vwCodeTables filter(TABLENAME=='POIProgram') ~> POIProgram",
						"srcSuspension select(mapColumn(",
						"          SDSUSPENSIONID,",
						"          ENDDATE,",
						"          STARTDATE,",
						"          STATUSCODE,",
						"          REASON,",
						"          PROGRAM",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectSrcColumns",
						"SelectDrvColumns, SDSuspensionReason lookup(REASON_Trim == CODE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LookupReason",
						"LookupReason select(mapColumn(",
						"          SDSUSPENSIONID,",
						"          ENDDATE,",
						"          STARTDATE,",
						"          STATUSCODE,",
						"          REASON,",
						"          PROGRAM,",
						"          STATUSCODE_Trim,",
						"          REASON_Trim,",
						"          PROGRAM_Trim,",
						"          ReasonDescription = DESCRIPTION",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectReason",
						"SelectReason, POIProgram lookup(PROGRAM_Trim == CODE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LookupProgram",
						"LookupProgram select(mapColumn(",
						"          SuspensionID = SDSUSPENSIONID,",
						"          SuspensionEndDate = ENDDATE,",
						"          SuspensionStartDate = STARTDATE,",
						"          SuspensionReason = ReasonDescription,",
						"          SuspensionProgramType = DESCRIPTION",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectProgram",
						"vwCodeTables filter(TABLENAME=='SDSuspensionReason') ~> SDSuspensionReason",
						"SelectSrcColumns derive(each(match(type=='string'), $$+'_Trim' = trim($$))) ~> drvTrimColumns",
						"drvTrimColumns select(mapColumn(",
						"          SDSUSPENSIONID,",
						"          ENDDATE,",
						"          STARTDATE,",
						"          STATUSCODE,",
						"          REASON,",
						"          PROGRAM,",
						"          STATUSCODE_Trim,",
						"          REASON_Trim,",
						"          PROGRAM_Trim",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectDrvColumns",
						"SelectProgram derive(each(match(type=='string'), $$+'_null' = iifNull($$,'NA')),",
						"          ModifiedDate = currentUTC()) ~> drvNullValues",
						"drvNullValues select(mapColumn(",
						"          SuspensionID,",
						"          SuspensionEndDate,",
						"          SuspensionStartDate,",
						"          SuspensionReason = SuspensionReason_null,",
						"          SuspensionProgramType = SuspensionProgramType_null,",
						"          ModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectNullColumns",
						"SelectNullColumns sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          Column_1 as string,",
						"          Column_2 as string,",
						"          Column_3 as string,",
						"          Column_4 as string,",
						"          Column_5 as string,",
						"          Column_6 as string",
						"     ),",
						"     partitionFileNames:['DimSuspension'],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> tgtDimSuspension"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/df_DimTask')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Dimensions"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "vwCodeTable",
								"type": "DatasetReference"
							},
							"name": "vwCodeTable"
						},
						{
							"dataset": {
								"referenceName": "Task",
								"type": "DatasetReference"
							},
							"name": "srcTask"
						},
						{
							"dataset": {
								"referenceName": "TaskDefinition",
								"type": "DatasetReference"
							},
							"name": "srcTaskDefinition"
						},
						{
							"dataset": {
								"referenceName": "TaskAssignment",
								"type": "DatasetReference"
							},
							"name": "srcTaskAssignment"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "DimensionTargetTesting",
								"type": "DatasetReference"
							},
							"name": "trgDimTask"
						}
					],
					"transformations": [
						{
							"name": "TargetItemType"
						},
						{
							"name": "TaskCategoryCode"
						},
						{
							"name": "TaskChangeType"
						},
						{
							"name": "TaskPriority"
						},
						{
							"name": "TaskStatus"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "drvTrimStringFields"
						},
						{
							"name": "LookupStatus",
							"description": "Lookup Status Code"
						},
						{
							"name": "LookupPriority"
						},
						{
							"name": "SelectStatus"
						},
						{
							"name": "SelectPriority"
						},
						{
							"name": "LookupCategory"
						},
						{
							"name": "SelectCategory"
						},
						{
							"name": "LookupAssignment"
						},
						{
							"name": "SelectAssignment"
						},
						{
							"name": "LookupTaskAllocation"
						},
						{
							"name": "SelectTaskAllocation"
						},
						{
							"name": "drvNullValues"
						},
						{
							"name": "SelectNullValues"
						}
					],
					"scriptLines": [
						"source(output(",
						"          TABLENAME as string,",
						"          CODE as string,",
						"          DESCRIPTION as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> vwCodeTable",
						"source(output(",
						"          TASKID as long,",
						"          WDOSNAPSHOT as string,",
						"          CREATIONTIME as timestamp,",
						"          ASSIGNEDDATETIME as timestamp,",
						"          TOTALTIMEWORKED as integer,",
						"          RESTARTTIME as timestamp,",
						"          RESERVEDBY as string,",
						"          STATUS as string,",
						"          PRIORITY as string,",
						"          CATEGORY as string,",
						"          DEADTIMEOVERIND as string,",
						"          ALLOWFORWARDIND as string,",
						"          ADMINISTRATIONSID as string,",
						"          OVERFLOWIND as string,",
						"          VERSIONNO as integer,",
						"          LASTWRITTEN as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> srcTask",
						"source(output(",
						"          TASKDEFINITIONID as string,",
						"          NAME as string,",
						"          CATEGORYCODE as string,",
						"          ALLOCATIONSTRATEGYCODE as string,",
						"          ALLOCATIONITEMID as long,",
						"          WORKALLOCATIONRULESETID as string,",
						"          DEADLINEFUNCTIONID as long,",
						"          DEADLINETIMEOUTINTERVAL as long,",
						"          ALLOWFORWARDIND as string,",
						"          ACTIONPAGENAME as string,",
						"          CASEIDPARAMETERNAME as string,",
						"          PARTICIPANTIDPARAMETERNAME as string,",
						"          ADMINISTRATIONSID as string,",
						"          COMMENTS as string,",
						"          ACTIONPAGENAMECODE as string,",
						"          DEADLINETIMEOVERRIDEIND as string,",
						"          VERSIONNO as integer,",
						"          LASTWRITTEN as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> srcTaskDefinition",
						"source(output(",
						"          TASKASSIGNMENTID as long,",
						"          TASKID as long,",
						"          ASSIGNEETYPE as string,",
						"          RELATEDID as long,",
						"          RELATEDNAME as string,",
						"          LASTWRITTEN as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> srcTaskAssignment",
						"vwCodeTable filter(TABLENAME=='TargetItemType') ~> TargetItemType",
						"vwCodeTable filter(TABLENAME=='TaskCategoryCode') ~> TaskCategoryCode",
						"vwCodeTable filter(TABLENAME=='TaskChangeType') ~> TaskChangeType",
						"vwCodeTable filter(TABLENAME=='TaskPriority') ~> TaskPriority",
						"vwCodeTable filter(TABLENAME=='TaskStatus') ~> TaskStatus",
						"srcTask select(mapColumn(",
						"          TASKID,",
						"          CREATIONTIME,",
						"          TOTALTIMEWORKED,",
						"          STATUS,",
						"          PRIORITY,",
						"          CATEGORY,",
						"          LASTWRITTEN",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SelectColumns derive(each(match(type=='string'), $$+'_Trim' = trim($$))) ~> drvTrimStringFields",
						"drvTrimStringFields, TaskStatus lookup(STATUS_Trim == CODE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LookupStatus",
						"SelectStatus, TaskPriority lookup(PRIORITY_Trim == CODE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LookupPriority",
						"LookupStatus select(mapColumn(",
						"          TASKID,",
						"          CREATIONTIME,",
						"          TOTALTIMEWORKED,",
						"          STATUS,",
						"          PRIORITY,",
						"          CATEGORY,",
						"          LASTWRITTEN,",
						"          STATUS_Trim,",
						"          PRIORITY_Trim,",
						"          CATEGORY_Trim,",
						"          StatusDescription = DESCRIPTION",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectStatus",
						"LookupPriority select(mapColumn(",
						"          TASKID,",
						"          CREATIONTIME,",
						"          TOTALTIMEWORKED,",
						"          STATUS,",
						"          PRIORITY,",
						"          CATEGORY,",
						"          LASTWRITTEN,",
						"          STATUS_Trim,",
						"          PRIORITY_Trim,",
						"          CATEGORY_Trim,",
						"          StatusDescription,",
						"          PriorityDescription = DESCRIPTION",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectPriority",
						"SelectPriority, TaskCategoryCode lookup(CATEGORY_Trim == CODE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LookupCategory",
						"LookupCategory select(mapColumn(",
						"          TASKID,",
						"          CREATIONTIME,",
						"          TOTALTIMEWORKED,",
						"          STATUS,",
						"          PRIORITY,",
						"          CATEGORY,",
						"          LASTWRITTEN,",
						"          STATUS_Trim,",
						"          PRIORITY_Trim,",
						"          CATEGORY_Trim,",
						"          StatusDescription,",
						"          PriorityDescription,",
						"          CategoryDescription = DESCRIPTION",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectCategory",
						"SelectCategory, srcTaskAssignment lookup(SelectCategory@TASKID == srcTaskAssignment@TASKID,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LookupAssignment",
						"LookupAssignment select(mapColumn(",
						"          TASKID = SelectCategory@TASKID,",
						"          CREATIONTIME,",
						"          TOTALTIMEWORKED,",
						"          STATUS,",
						"          PRIORITY,",
						"          CATEGORY,",
						"          LASTWRITTEN = SelectCategory@LASTWRITTEN,",
						"          STATUS_Trim,",
						"          PRIORITY_Trim,",
						"          CATEGORY_Trim,",
						"          StatusDescription,",
						"          PriorityDescription,",
						"          CategoryDescription,",
						"          ASSIGNEETYPE",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectAssignment",
						"SelectAssignment, TargetItemType lookup(trim(ASSIGNEETYPE) == CODE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LookupTaskAllocation",
						"LookupTaskAllocation select(mapColumn(",
						"          TaskID = TASKID,",
						"          TaskCreationTime = CREATIONTIME,",
						"          TaskTotalTimeWorked = TOTALTIMEWORKED,",
						"          TaskStatus = StatusDescription,",
						"          TaskPriority = PriorityDescription,",
						"          TaskCategory = CategoryDescription,",
						"          TaskAllocationTarget = DESCRIPTION",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectTaskAllocation",
						"SelectTaskAllocation derive(ModifiedDate = currentUTC(),",
						"          each(match(type=='string'), $$+'_null' = iifNull($$,'NA'))) ~> drvNullValues",
						"drvNullValues select(mapColumn(",
						"          TaskID,",
						"          TaskCreationTime,",
						"          TaskTotalTimeWorked,",
						"          ModifiedDate,",
						"          TaskStatus = TaskStatus_null,",
						"          TaskPriority = TaskPriority_null,",
						"          TaskCategory = TaskCategory_null,",
						"          TaskAllocationTarget = TaskAllocationTarget_null",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectNullValues",
						"SelectNullValues sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          Column_1 as string,",
						"          Column_2 as string,",
						"          Column_3 as string,",
						"          Column_4 as string,",
						"          Column_5 as string,",
						"          Column_6 as string",
						"     ),",
						"     partitionFileNames:['DimTask.txt'],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> trgDimTask"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/df_DynamicSelect')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Staging"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "db2DynamicSource",
								"type": "DatasetReference"
							},
							"name": "RptDBTEST"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "stgDynamicTarget",
								"type": "DatasetReference"
							},
							"name": "StgDBTEST"
						}
					],
					"transformations": [
						{
							"name": "Upsert"
						}
					],
					"scriptLines": [
						"parameters{",
						"     ptblTableName as string,",
						"     ptblLastWritten as string,",
						"     ptblPrimaryKeyColumn as string,",
						"     ptblSchema as string",
						"}",
						"source(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     waterMarkColumn: 'LastWritten',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     query: (\"SELECT * FROM CURAPD01.\"+$ptblTableName+\" where Lastwritten>='\"+$ptblLastWritten+\"'\"                    ),",
						"     format: 'query',",
						"     mode: 'read') ~> RptDBTEST",
						"RptDBTEST alterRow(upsertIf(true())) ~> Upsert",
						"Upsert sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:[($ptblPrimaryKeyColumn)],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> StgDBTEST"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/df_FactSalesOrderHeader')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Final df POCs"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "reportingSalesOrderHeader",
								"type": "DatasetReference"
							},
							"name": "reportingSalesOrderHeader"
						},
						{
							"dataset": {
								"referenceName": "DimAddress",
								"type": "DatasetReference"
							},
							"name": "DimAddress"
						},
						{
							"dataset": {
								"referenceName": "DimCustomer",
								"type": "DatasetReference"
							},
							"name": "DimCustomer"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "targetSalesOrderHeader",
								"type": "DatasetReference"
							},
							"name": "targetSalesOrderHeader"
						}
					],
					"transformations": [
						{
							"name": "LkpShipToAddress",
							"description": "Add second stream to the Lookup from settings. Lookup ShipTo Address"
						},
						{
							"name": "LkpBillToAddress",
							"description": "Add second stream to the Lookup from settings. Lookup BillTo Address"
						},
						{
							"name": "SelectColumnsWShipToDescription"
						},
						{
							"name": "SelectColumnsWBillToAddress"
						},
						{
							"name": "LkpCustomerDescription",
							"description": "Add second stream to the Lookup from settings. Lookup Customer Description"
						},
						{
							"name": "SelectColumnsWCustomerDescription"
						},
						{
							"name": "Upsert"
						}
					],
					"scriptLines": [
						"source(output(",
						"          SalesOrderID as integer,",
						"          RevisionNumber as integer,",
						"          OrderDate as timestamp,",
						"          DueDate as timestamp,",
						"          ShipDate as timestamp,",
						"          Status as integer,",
						"          OnlineOrderFlag as boolean,",
						"          SalesOrderNumber as string,",
						"          PurchaseOrderNumber as string,",
						"          AccountNumber as string,",
						"          CustomerID as integer,",
						"          ShipToAddressID as integer,",
						"          BillToAddressID as integer,",
						"          ShipMethod as string,",
						"          CreditCardApprovalCode as string,",
						"          SubTotal as decimal(19,4),",
						"          TaxAmt as decimal(19,4),",
						"          Freight as decimal(19,4),",
						"          TotalDue as decimal(19,4),",
						"          Comment as string,",
						"          rowguid as string,",
						"          ModifiedDate as timestamp",
						"     ),",
						"     allowSchemaDrift: false,",
						"     validateSchema: false,",
						"     waterMarkColumn: 'ModifiedDate',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table',",
						"     mode: 'read') ~> reportingSalesOrderHeader",
						"source(output(",
						"          AddressID as integer,",
						"          AddressLine1 as string,",
						"          AddressLine2 as string,",
						"          City as string,",
						"          StateProvince as string,",
						"          CountryRegion as string,",
						"          PostalCode as string,",
						"          rowguid as string,",
						"          ModifiedDate as timestamp",
						"     ),",
						"     allowSchemaDrift: false,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> DimAddress",
						"source(output(",
						"          CustomerID as integer,",
						"          NameStyle as boolean,",
						"          Title as string,",
						"          FirstName as string,",
						"          MiddleName as string,",
						"          LastName as string,",
						"          Suffix as string,",
						"          CompanyName as string,",
						"          SalesPerson as string,",
						"          EmailAddress as string,",
						"          Phone as string,",
						"          PasswordHash as string,",
						"          PasswordSalt as string,",
						"          rowguid as string,",
						"          ModifiedDate as timestamp",
						"     ),",
						"     allowSchemaDrift: false,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> DimCustomer",
						"reportingSalesOrderHeader, DimAddress lookup(ShipToAddressID == AddressID,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LkpShipToAddress",
						"SelectColumnsWShipToDescription, DimAddress lookup(BillToAddressID == AddressID,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LkpBillToAddress",
						"LkpShipToAddress select(mapColumn(",
						"          SalesOrderID,",
						"          OrderDate,",
						"          Status,",
						"          SalesOrderNumber,",
						"          PurchaseOrderNumber,",
						"          AccountNumber,",
						"          CustomerID,",
						"          ShipToAddressID,",
						"          BillToAddressID,",
						"          ShipMethod,",
						"          SubTotal,",
						"          TaxAmt,",
						"          Freight,",
						"          TotalDue,",
						"          Comment,",
						"          rowguid = reportingSalesOrderHeader@rowguid,",
						"          ModifiedDate = reportingSalesOrderHeader@ModifiedDate,",
						"          ShipToAddressLine1 = AddressLine1",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumnsWShipToDescription",
						"LkpBillToAddress select(mapColumn(",
						"          SalesOrderID,",
						"          OrderDate,",
						"          Status,",
						"          SalesOrderNumber,",
						"          PurchaseOrderNumber,",
						"          AccountNumber,",
						"          CustomerID,",
						"          ShipToAddressID,",
						"          BillToAddressID,",
						"          ShipMethod,",
						"          SubTotal,",
						"          TaxAmt,",
						"          Freight,",
						"          TotalDue,",
						"          ModifiedDate = SelectColumnsWShipToDescription@ModifiedDate,",
						"          ShipToAddressLine1,",
						"          BillToAddressLine1 = AddressLine1",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumnsWBillToAddress",
						"SelectColumnsWBillToAddress, DimCustomer lookup(SelectColumnsWBillToAddress@CustomerID == DimCustomer@CustomerID,",
						"     multiple: false,",
						"     pickup: 'first',",
						"     asc(DimCustomer@CustomerID, true),",
						"     broadcast: 'auto')~> LkpCustomerDescription",
						"LkpCustomerDescription select(mapColumn(",
						"          SalesOrderID,",
						"          OrderDate,",
						"          Status,",
						"          SalesOrderNumber,",
						"          PurchaseOrderNumber,",
						"          AccountNumber,",
						"          ShipMethod,",
						"          SubTotal,",
						"          TaxAmt,",
						"          Freight,",
						"          TotalDue,",
						"          ModifiedDate = SelectColumnsWBillToAddress@ModifiedDate,",
						"          ShipToAddressDescription = ShipToAddressLine1,",
						"          BillToAddressDesciption = BillToAddressLine1,",
						"          CustomerDescription = CompanyName",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumnsWCustomerDescription",
						"SelectColumnsWCustomerDescription alterRow(upsertIf(true())) ~> Upsert",
						"Upsert sink(allowSchemaDrift: false,",
						"     validateSchema: false,",
						"     input(",
						"          SalesOrderID as integer,",
						"          OrderDate as timestamp,",
						"          Status as integer,",
						"          SalesOrderNumber as string,",
						"          PurchaseOrderNumber as string,",
						"          AccountNumber as string,",
						"          CustomerDescription as string,",
						"          ShipToAddressDescription as string,",
						"          BillToAddressDesciption as string,",
						"          ShipMethod as string,",
						"          SubTotal as decimal(19,4),",
						"          TaxAmt as decimal(19,4),",
						"          Freight as decimal(19,4),",
						"          TotalDue as decimal(19,4),",
						"          ModifiedDate as timestamp",
						"     ),",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['SalesOrderID'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'allErrors',",
						"     transactionCommit: 'single',",
						"     reportSuccessOnError: false,",
						"     mapColumn(",
						"          SalesOrderID,",
						"          OrderDate,",
						"          Status,",
						"          SalesOrderNumber,",
						"          PurchaseOrderNumber,",
						"          AccountNumber,",
						"          CustomerDescription,",
						"          ShipToAddressDescription,",
						"          BillToAddressDesciption,",
						"          ShipMethod,",
						"          SubTotal,",
						"          TaxAmt,",
						"          Freight,",
						"          TotalDue,",
						"          ModifiedDate",
						"     )) ~> targetSalesOrderHeader"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/df_FactSalesOrderHeader_wo_CDC')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Final df POCs"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "reportingSalesOrderHeader",
								"type": "DatasetReference"
							},
							"name": "reportingSalesOrderHeader"
						},
						{
							"dataset": {
								"referenceName": "DimAddress",
								"type": "DatasetReference"
							},
							"name": "DimAddress"
						},
						{
							"dataset": {
								"referenceName": "DimCustomer",
								"type": "DatasetReference"
							},
							"name": "DimCustomer"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "targetSalesOrderHeader",
								"type": "DatasetReference"
							},
							"name": "targetSalesOrderHeader"
						}
					],
					"transformations": [
						{
							"name": "LkpShipToAddress",
							"description": "Add second stream to the Lookup from settings. Lookup ShipTo Address"
						},
						{
							"name": "LkpBillToAddress",
							"description": "Add second stream to the Lookup from settings. Lookup BillTo Address"
						},
						{
							"name": "SelectColumnsWShipToDescription"
						},
						{
							"name": "SelectColumnsWBillToAddress"
						},
						{
							"name": "LkpCustomerDescription",
							"description": "Add second stream to the Lookup from settings. Lookup Customer Description"
						},
						{
							"name": "SelectColumnsWCustomerDescription"
						},
						{
							"name": "Upsert"
						}
					],
					"scriptLines": [
						"source(output(",
						"          SalesOrderID as integer,",
						"          RevisionNumber as integer,",
						"          OrderDate as timestamp,",
						"          DueDate as timestamp,",
						"          ShipDate as timestamp,",
						"          Status as integer,",
						"          OnlineOrderFlag as boolean,",
						"          SalesOrderNumber as string,",
						"          PurchaseOrderNumber as string,",
						"          AccountNumber as string,",
						"          CustomerID as integer,",
						"          ShipToAddressID as integer,",
						"          BillToAddressID as integer,",
						"          ShipMethod as string,",
						"          CreditCardApprovalCode as string,",
						"          SubTotal as decimal(19,4),",
						"          TaxAmt as decimal(19,4),",
						"          Freight as decimal(19,4),",
						"          TotalDue as decimal(19,4),",
						"          Comment as string,",
						"          rowguid as string,",
						"          ModifiedDate as timestamp",
						"     ),",
						"     allowSchemaDrift: false,",
						"     validateSchema: false,",
						"     waterMarkColumn: 'ModifiedDate',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table',",
						"     mode: 'read') ~> reportingSalesOrderHeader",
						"source(output(",
						"          AddressID as integer,",
						"          AddressLine1 as string,",
						"          AddressLine2 as string,",
						"          City as string,",
						"          StateProvince as string,",
						"          CountryRegion as string,",
						"          PostalCode as string,",
						"          rowguid as string,",
						"          ModifiedDate as timestamp",
						"     ),",
						"     allowSchemaDrift: false,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> DimAddress",
						"source(output(",
						"          CustomerID as integer,",
						"          NameStyle as boolean,",
						"          Title as string,",
						"          FirstName as string,",
						"          MiddleName as string,",
						"          LastName as string,",
						"          Suffix as string,",
						"          CompanyName as string,",
						"          SalesPerson as string,",
						"          EmailAddress as string,",
						"          Phone as string,",
						"          PasswordHash as string,",
						"          PasswordSalt as string,",
						"          rowguid as string,",
						"          ModifiedDate as timestamp",
						"     ),",
						"     allowSchemaDrift: false,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> DimCustomer",
						"reportingSalesOrderHeader, DimAddress lookup(ShipToAddressID == AddressID,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LkpShipToAddress",
						"SelectColumnsWShipToDescription, DimAddress lookup(BillToAddressID == AddressID,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LkpBillToAddress",
						"LkpShipToAddress select(mapColumn(",
						"          SalesOrderID,",
						"          OrderDate,",
						"          Status,",
						"          SalesOrderNumber,",
						"          PurchaseOrderNumber,",
						"          AccountNumber,",
						"          CustomerID,",
						"          ShipToAddressID,",
						"          BillToAddressID,",
						"          ShipMethod,",
						"          SubTotal,",
						"          TaxAmt,",
						"          Freight,",
						"          TotalDue,",
						"          Comment,",
						"          rowguid = reportingSalesOrderHeader@rowguid,",
						"          ModifiedDate = reportingSalesOrderHeader@ModifiedDate,",
						"          ShipToAddressLine1 = AddressLine1",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumnsWShipToDescription",
						"LkpBillToAddress select(mapColumn(",
						"          SalesOrderID,",
						"          OrderDate,",
						"          Status,",
						"          SalesOrderNumber,",
						"          PurchaseOrderNumber,",
						"          AccountNumber,",
						"          CustomerID,",
						"          ShipToAddressID,",
						"          BillToAddressID,",
						"          ShipMethod,",
						"          SubTotal,",
						"          TaxAmt,",
						"          Freight,",
						"          TotalDue,",
						"          ModifiedDate = SelectColumnsWShipToDescription@ModifiedDate,",
						"          ShipToAddressLine1,",
						"          BillToAddressLine1 = AddressLine1",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumnsWBillToAddress",
						"SelectColumnsWBillToAddress, DimCustomer lookup(SelectColumnsWBillToAddress@CustomerID == DimCustomer@CustomerID,",
						"     multiple: false,",
						"     pickup: 'first',",
						"     asc(DimCustomer@CustomerID, true),",
						"     broadcast: 'auto')~> LkpCustomerDescription",
						"LkpCustomerDescription select(mapColumn(",
						"          SalesOrderID,",
						"          OrderDate,",
						"          Status,",
						"          SalesOrderNumber,",
						"          PurchaseOrderNumber,",
						"          AccountNumber,",
						"          ShipMethod,",
						"          SubTotal,",
						"          TaxAmt,",
						"          Freight,",
						"          TotalDue,",
						"          ModifiedDate = SelectColumnsWBillToAddress@ModifiedDate,",
						"          ShipToAddressDescription = ShipToAddressLine1,",
						"          BillToAddressDesciption = BillToAddressLine1,",
						"          CustomerDescription = CompanyName",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumnsWCustomerDescription",
						"SelectColumnsWCustomerDescription alterRow(upsertIf(true())) ~> Upsert",
						"Upsert sink(allowSchemaDrift: false,",
						"     validateSchema: false,",
						"     input(",
						"          SalesOrderID as integer,",
						"          OrderDate as timestamp,",
						"          Status as integer,",
						"          SalesOrderNumber as string,",
						"          PurchaseOrderNumber as string,",
						"          AccountNumber as string,",
						"          CustomerDescription as string,",
						"          ShipToAddressDescription as string,",
						"          BillToAddressDesciption as string,",
						"          ShipMethod as string,",
						"          SubTotal as decimal(19,4),",
						"          TaxAmt as decimal(19,4),",
						"          Freight as decimal(19,4),",
						"          TotalDue as decimal(19,4),",
						"          ModifiedDate as timestamp",
						"     ),",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['SalesOrderID'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'allErrors',",
						"     transactionCommit: 'single',",
						"     reportSuccessOnError: false,",
						"     mapColumn(",
						"          SalesOrderID,",
						"          OrderDate,",
						"          Status,",
						"          SalesOrderNumber,",
						"          PurchaseOrderNumber,",
						"          AccountNumber,",
						"          CustomerDescription,",
						"          ShipToAddressDescription,",
						"          BillToAddressDesciption,",
						"          ShipMethod,",
						"          SubTotal,",
						"          TaxAmt,",
						"          Freight,",
						"          TotalDue,",
						"          ModifiedDate",
						"     )) ~> targetSalesOrderHeader"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/df_Fixed_Width_Test')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Final df POCs"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "DimCustomerAWDW",
								"type": "DatasetReference"
							},
							"name": "srcDimCustomer"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "EmailFile",
								"type": "DatasetReference"
							},
							"name": "tgtEmailFile"
						},
						{
							"dataset": {
								"referenceName": "SFTPFixedWidthFile",
								"type": "DatasetReference"
							},
							"name": "tgtSFTPServer"
						}
					],
					"transformations": [
						{
							"name": "SelectColumns"
						},
						{
							"name": "ConcatFields"
						},
						{
							"name": "SelectConcatString"
						},
						{
							"name": "IffNullTrim"
						}
					],
					"scriptLines": [
						"source(output(",
						"          CustomerKey as integer,",
						"          GeographyKey as integer,",
						"          CustomerAlternateKey as string,",
						"          Title as string,",
						"          FirstName as string,",
						"          MiddleName as string,",
						"          LastName as string,",
						"          NameStyle as boolean,",
						"          BirthDate as date,",
						"          MaritalStatus as string,",
						"          Suffix as string,",
						"          Gender as string,",
						"          EmailAddress as string,",
						"          YearlyIncome as decimal(19,4),",
						"          TotalChildren as integer,",
						"          NumberChildrenAtHome as integer,",
						"          EnglishEducation as string,",
						"          SpanishEducation as string,",
						"          FrenchEducation as string,",
						"          EnglishOccupation as string,",
						"          SpanishOccupation as string,",
						"          FrenchOccupation as string,",
						"          HouseOwnerFlag as string,",
						"          NumberCarsOwned as integer,",
						"          AddressLine1 as string,",
						"          AddressLine2 as string,",
						"          Phone as string,",
						"          DateFirstPurchase as date,",
						"          CommuteDistance as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> srcDimCustomer",
						"srcDimCustomer select(mapColumn(",
						"          CustomerAlternateKey,",
						"          Title,",
						"          FirstName,",
						"          MiddleName,",
						"          LastName,",
						"          BirthDate,",
						"          MaritalStatus,",
						"          Suffix,",
						"          Gender,",
						"          TotalChildren,",
						"          EnglishEducation,",
						"          EnglishOccupation,",
						"          HouseOwnerFlag,",
						"          AddressLine1,",
						"          Phone",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"IffNullTrim derive(drvConcatAll = concat(rpad(FirstName,15,' '),rpad(MiddleName, 1, ' '),rpad(LastName, 20, ' '),rpad(AddressLine1, 45, ' '),rpad(EnglishEducation, 10, ' '))) ~> ConcatFields",
						"ConcatFields select(mapColumn(",
						"          ConcatAll = drvConcatAll",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectConcatString",
						"SelectColumns derive(FirstName = iifNull(trim(FirstName) ,'' ),",
						"          LastName = iifNull(trim(LastName) ,'' ),",
						"          MiddleName = iifNull(trim(MiddleName) ,'' ),",
						"          AddressLine1 = iifNull(trim(AddressLine1) ,'' ),",
						"          EnglishEducation = iifNull(trim(EnglishEducation) ,'' )) ~> IffNullTrim",
						"SelectConcatString sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     partitionFileNames:['EmailFile'],",
						"     truncate: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> tgtEmailFile",
						"SelectConcatString sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          Column_1 as string",
						"     ),",
						"     partitionFileNames:['FixedWidth.txt'],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> tgtSFTPServer"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/df_Fixed_Width_Test_No_SMTP')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Final df POCs"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "DimCustomerAWDW",
								"type": "DatasetReference"
							},
							"name": "srcDimCustomer"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Dummy",
								"type": "DatasetReference"
							},
							"name": "tgtDummyOutput"
						},
						{
							"dataset": {
								"referenceName": "EmailFile",
								"type": "DatasetReference"
							},
							"name": "tgtEmailFile"
						}
					],
					"transformations": [
						{
							"name": "SelectColumns"
						},
						{
							"name": "ConcatFields"
						},
						{
							"name": "SelectConcatString"
						},
						{
							"name": "IffNullTrim"
						}
					],
					"scriptLines": [
						"source(output(",
						"          CustomerKey as integer,",
						"          GeographyKey as integer,",
						"          CustomerAlternateKey as string,",
						"          Title as string,",
						"          FirstName as string,",
						"          MiddleName as string,",
						"          LastName as string,",
						"          NameStyle as boolean,",
						"          BirthDate as date,",
						"          MaritalStatus as string,",
						"          Suffix as string,",
						"          Gender as string,",
						"          EmailAddress as string,",
						"          YearlyIncome as decimal(19,4),",
						"          TotalChildren as integer,",
						"          NumberChildrenAtHome as integer,",
						"          EnglishEducation as string,",
						"          SpanishEducation as string,",
						"          FrenchEducation as string,",
						"          EnglishOccupation as string,",
						"          SpanishOccupation as string,",
						"          FrenchOccupation as string,",
						"          HouseOwnerFlag as string,",
						"          NumberCarsOwned as integer,",
						"          AddressLine1 as string,",
						"          AddressLine2 as string,",
						"          Phone as string,",
						"          DateFirstPurchase as date,",
						"          CommuteDistance as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> srcDimCustomer",
						"srcDimCustomer select(mapColumn(",
						"          CustomerAlternateKey,",
						"          Title,",
						"          FirstName,",
						"          MiddleName,",
						"          LastName,",
						"          BirthDate,",
						"          MaritalStatus,",
						"          Suffix,",
						"          Gender,",
						"          TotalChildren,",
						"          EnglishEducation,",
						"          EnglishOccupation,",
						"          HouseOwnerFlag,",
						"          AddressLine1,",
						"          Phone",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"IffNullTrim derive(drvConcatAll = concat(rpad(FirstName,15,' '),rpad(MiddleName, 1, ' '),rpad(LastName, 20, ' '),rpad(AddressLine1, 45, ' '),rpad(EnglishEducation, 10, ' '))) ~> ConcatFields",
						"ConcatFields select(mapColumn(",
						"          ConcatAll = drvConcatAll",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectConcatString",
						"SelectColumns derive(FirstName = iifNull(trim(FirstName) ,'' ),",
						"          LastName = iifNull(trim(LastName) ,'' ),",
						"          MiddleName = iifNull(trim(MiddleName) ,'' ),",
						"          AddressLine1 = iifNull(trim(AddressLine1) ,'' ),",
						"          EnglishEducation = iifNull(trim(EnglishEducation) ,'' )) ~> IffNullTrim",
						"SelectConcatString sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          Column_1 as string",
						"     ),",
						"     partitionFileNames:['FixedWidthTest.txt'],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> tgtDummyOutput",
						"SelectConcatString sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     partitionFileNames:['EmailFile'],",
						"     truncate: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> tgtEmailFile"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/df_Lookup_Template_Case')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Final df POCs"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "vwCodeTable",
								"type": "DatasetReference"
							},
							"name": "vwCodeTables"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Dummy1",
								"type": "DatasetReference"
							},
							"name": "DummyFile"
						}
					],
					"transformations": [
						{
							"name": "CaseObjective"
						},
						{
							"name": "CaseStatus"
						},
						{
							"name": "CasePriority"
						},
						{
							"name": "CaseOutcome"
						},
						{
							"name": "CaseClassification"
						},
						{
							"name": "CaseTypeCode"
						}
					],
					"scriptLines": [
						"source(output(",
						"          TABLENAME as string,",
						"          CODE as string,",
						"          DESCRIPTION as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> vwCodeTables",
						"vwCodeTables filter(TABLENAME=='CaseObjective') ~> CaseObjective",
						"vwCodeTables filter(TABLENAME=='CaseStatus') ~> CaseStatus",
						"vwCodeTables filter(TABLENAME=='CasePriority') ~> CasePriority",
						"vwCodeTables filter(TABLENAME=='CaseOutcome') ~> CaseOutcome",
						"vwCodeTables filter(TABLENAME=='CaseClassification') ~> CaseClassification",
						"vwCodeTables filter(TABLENAME=='CaseTypeCode') ~> CaseTypeCode",
						"CaseObjective sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          Column_1 as string",
						"     ),",
						"     partitionFileNames:['CaseHeaderPOC'],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> DummyFile"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/df_Lookup_Template_For_Starter')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Final df POCs"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "vwCodeTable",
								"type": "DatasetReference"
							},
							"name": "vwCodeTables"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Dummy1",
								"type": "DatasetReference"
							},
							"name": "DummyFile"
						}
					],
					"transformations": [
						{
							"name": "CaseObjective"
						},
						{
							"name": "CaseStatus"
						},
						{
							"name": "CasePriority"
						},
						{
							"name": "CaseOutcome"
						},
						{
							"name": "CaseClassification"
						},
						{
							"name": "CaseTypeCode"
						}
					],
					"scriptLines": [
						"source(output(",
						"          TABLENAME as string,",
						"          CODE as string,",
						"          DESCRIPTION as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> vwCodeTables",
						"vwCodeTables filter(TABLENAME=='CaseObjective') ~> CaseObjective",
						"vwCodeTables filter(TABLENAME=='CaseStatus') ~> CaseStatus",
						"vwCodeTables filter(TABLENAME=='CasePriority') ~> CasePriority",
						"vwCodeTables filter(TABLENAME=='CaseOutcome') ~> CaseOutcome",
						"vwCodeTables filter(TABLENAME=='CaseClassification') ~> CaseClassification",
						"vwCodeTables filter(TABLENAME=='CaseTypeCode') ~> CaseTypeCode",
						"CaseObjective sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          Column_1 as string",
						"     ),",
						"     partitionFileNames:['CaseHeaderPOC'],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> DummyFile"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/df_Lookup_Template_POC')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Final df POCs"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "vwCodeTable",
								"type": "DatasetReference"
							},
							"name": "vwCodeTables"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "ds_Dummy_Lookup",
								"type": "DatasetReference"
							},
							"name": "tgtDummyFile"
						}
					],
					"transformations": [
						{
							"name": "ActionPageNameCode"
						},
						{
							"name": "ActivityCategory"
						},
						{
							"name": "AddressCountry"
						},
						{
							"name": "AddressLayoutType"
						},
						{
							"name": "AddressState"
						},
						{
							"name": "AddressType"
						},
						{
							"name": "AddressUSCounty"
						},
						{
							"name": "AdviceParameterType"
						},
						{
							"name": "AESShareSetStatus"
						},
						{
							"name": "AESShareSetType"
						},
						{
							"name": "AllocationStrategyCode"
						},
						{
							"name": "AlternateNameType"
						},
						{
							"name": "ApplicantRole"
						},
						{
							"name": "ApplicantStatus"
						},
						{
							"name": "APPLICATIONCODE"
						},
						{
							"name": "ApplicationCaseStatus"
						},
						{
							"name": "ApplicationChannel"
						},
						{
							"name": "ApplicationFiledByType"
						},
						{
							"name": "ApplicationMethod"
						},
						{
							"name": "ApplicationReassignReason"
						},
						{
							"name": "ApplicationRoleStatus"
						},
						{
							"name": "ApplicationRoleType"
						},
						{
							"name": "ApplicationStatus"
						},
						{
							"name": "ApplicationType"
						},
						{
							"name": "AssessmentDateListType"
						},
						{
							"name": "BranchOfService"
						},
						{
							"name": "CaseAssessmentDetReason"
						},
						{
							"name": "CaseCatTypeCode"
						},
						{
							"name": "CaseClassification"
						},
						{
							"name": "CaseDecisionStatusCode"
						},
						{
							"name": "CaseDeterminationStatus"
						},
						{
							"name": "CaseDeterminationType"
						},
						{
							"name": "CaseDetEvidenceUsed"
						},
						{
							"name": "CaseObjective"
						},
						{
							"name": "CaseOutcome"
						},
						{
							"name": "CaseParticipantRoleType"
						},
						{
							"name": "CasePriority"
						},
						{
							"name": "CaseSnapshoDetReason"
						},
						{
							"name": "CaseStatus"
						},
						{
							"name": "CaseTypeCode"
						},
						{
							"name": "CategoryActionState"
						},
						{
							"name": "CategoryName"
						},
						{
							"name": "CategoryTitle"
						},
						{
							"name": "CIPreferredContact"
						},
						{
							"name": "CIReferralResason"
						},
						{
							"name": "ClassDivisionType"
						},
						{
							"name": "ClientRegistration"
						},
						{
							"name": "CommunicationMethod"
						},
						{
							"name": "CommunicationType"
						},
						{
							"name": "CompanyType"
						},
						{
							"name": "ConcernRoleAlternateID"
						},
						{
							"name": "ConcernRoleStatus"
						},
						{
							"name": "ConcernRoleType"
						},
						{
							"name": "ConstraintType"
						},
						{
							"name": "ContractType"
						},
						{
							"name": "CopayCap"
						},
						{
							"name": "Country"
						},
						{
							"name": "CountyDetailsLinkedType"
						},
						{
							"name": "CoverageEndReason"
						},
						{
							"name": "CoverageType"
						},
						{
							"name": "CreoleValueState"
						},
						{
							"name": "Currency"
						},
						{
							"name": "DADisabilityConditionType"
						},
						{
							"name": "DeterminationCompStrategy"
						},
						{
							"name": "DetIntSummarizerStrategy"
						},
						{
							"name": "DETVersionStatus"
						},
						{
							"name": "EmailType"
						},
						{
							"name": "EthnicOrigin"
						},
						{
							"name": "EvidenceChangeReason"
						},
						{
							"name": "EvidenceDescriptorStatus"
						},
						{
							"name": "EvidenceType"
						},
						{
							"name": "EvMaintenancePattern"
						},
						{
							"name": "ExpectedLengthOfStay"
						},
						{
							"name": "ExpiryDateFrom"
						},
						{
							"name": "FrequencyCode"
						},
						{
							"name": "Gender"
						},
						{
							"name": "GrantorType"
						},
						{
							"name": "IndustryType"
						},
						{
							"name": "IntakeClientType"
						},
						{
							"name": "IntakeProcessDefntnState"
						},
						{
							"name": "IntakeProgApplDenyReason"
						},
						{
							"name": "IntakeProgApplStatus"
						},
						{
							"name": "Language"
						},
						{
							"name": "LevelOfCareType"
						},
						{
							"name": "LiabilityReassessmentType"
						},
						{
							"name": "Locale"
						},
						{
							"name": "LocationStatus"
						},
						{
							"name": "LocationType"
						},
						{
							"name": "MaritalStatus"
						},
						{
							"name": "MedicalInstitutionType"
						},
						{
							"name": "MethodOfApplication"
						},
						{
							"name": "MethodOfDelivery"
						},
						{
							"name": "MilitaryRank"
						},
						{
							"name": "Nationality"
						},
						{
							"name": "OccupationType"
						},
						{
							"name": "OutcomeAchieved"
						},
						{
							"name": "OverUnderPmntProcessing"
						},
						{
							"name": "ParticipantRoleEndReason"
						},
						{
							"name": "PersonTitle"
						},
						{
							"name": "PersonType"
						},
						{
							"name": "PhoneType"
						},
						{
							"name": "PlacedByFiledBy"
						},
						{
							"name": "PlacedByType"
						},
						{
							"name": "POIProgram"
						},
						{
							"name": "PreferredSEMethod"
						},
						{
							"name": "ProductAdminCategory"
						},
						{
							"name": "ProductCategory"
						},
						{
							"name": "ProductCoverPeriod"
						},
						{
							"name": "ProductDeliveryCategory"
						},
						{
							"name": "ProductName"
						},
						{
							"name": "ProductReassessmentStrat"
						},
						{
							"name": "ProductRoundType"
						},
						{
							"name": "ProductType"
						},
						{
							"name": "ProgAppStatusTransReason"
						},
						{
							"name": "ProgGrpDeterminationType"
						},
						{
							"name": "ProgramActionType"
						},
						{
							"name": "ProgramName"
						},
						{
							"name": "ProgramStatus"
						},
						{
							"name": "ProgramStatusReason"
						},
						{
							"name": "ProgramType"
						},
						{
							"name": "ProgRecEligibilityStatus"
						},
						{
							"name": "ProgRecEligibStartDate"
						},
						{
							"name": "ProgRecEvidenceUsed"
						},
						{
							"name": "ProgRecExecutionStatus"
						},
						{
							"name": "PropertyCategory"
						},
						{
							"name": "PropertyType"
						},
						{
							"name": "ProviderCategory"
						},
						{
							"name": "ProviderCategoryEndReason"
						},
						{
							"name": "ProviderStatus"
						},
						{
							"name": "RateCellType"
						},
						{
							"name": "RateColumnType"
						},
						{
							"name": "RateRowType"
						},
						{
							"name": "RateStatus"
						},
						{
							"name": "RateTableType"
						},
						{
							"name": "RecordStatus"
						},
						{
							"name": "ReferralSource"
						},
						{
							"name": "ReimbursementType"
						},
						{
							"name": "RelationshipEndReason"
						},
						{
							"name": "RelationshipTypeCode"
						},
						{
							"name": "RepresentativeType"
						},
						{
							"name": "ReverificationMode"
						},
						{
							"name": "RshipToPolicyholder"
						},
						{
							"name": "SDAssessmentMethod"
						},
						{
							"name": "SDAssessmentReason"
						},
						{
							"name": "SDCalculationRule"
						},
						{
							"name": "SDCREOLECaseDetAction"
						},
						{
							"name": "SDCREOLECaseDetRecStatus"
						},
						{
							"name": "SDCREOLECaseDetStatus"
						},
						{
							"name": "SDIHSCoPayInd"
						},
						{
							"name": "SDMAForcedEligReason"
						},
						{
							"name": "SDMedAidPrgmCatClass"
						},
						{
							"name": "SDPolicyholderRole"
						},
						{
							"name": "SDProdHeirarchyCat"
						},
						{
							"name": "SDRecertificationStatus"
						},
						{
							"name": "SDRegionApplicationType"
						},
						{
							"name": "SDSuspensionReason"
						},
						{
							"name": "SDTribalEnrollmentInd"
						},
						{
							"name": "SDTribeCode"
						},
						{
							"name": "SecretQuestionType"
						},
						{
							"name": "Sensitivity"
						},
						{
							"name": "ServCessReason"
						},
						{
							"name": "ServiceType"
						},
						{
							"name": "SourceOfFund"
						},
						{
							"name": "SpecialInterest"
						},
						{
							"name": "StateCodes"
						},
						{
							"name": "TargetItemType"
						},
						{
							"name": "TaskCategoryCode"
						},
						{
							"name": "TaskChangeType"
						},
						{
							"name": "TaskPriority"
						},
						{
							"name": "TaskStatus"
						},
						{
							"name": "TemplateIDCode"
						},
						{
							"name": "ThirdPartyProductType"
						},
						{
							"name": "TrustCategory"
						},
						{
							"name": "TrusteeType"
						},
						{
							"name": "TrustIncomeType"
						},
						{
							"name": "TrustType"
						},
						{
							"name": "UndueHardshipReason"
						},
						{
							"name": "UnearnedIncomeType"
						},
						{
							"name": "UnearnedRentIncExpType"
						},
						{
							"name": "URATypeAction"
						},
						{
							"name": "UserGrade"
						},
						{
							"name": "UserRecentActionType"
						},
						{
							"name": "UserSearchType"
						},
						{
							"name": "UtahCounties"
						},
						{
							"name": "UtilityExpenseType"
						},
						{
							"name": "UtilityType"
						},
						{
							"name": "VehicleMake"
						},
						{
							"name": "VehicleUsageCode"
						},
						{
							"name": "VerifiableItemName"
						},
						{
							"name": "VerificationCatName"
						},
						{
							"name": "VerificationDueDateFrom"
						},
						{
							"name": "VerificationItemName"
						},
						{
							"name": "VerificationItemType"
						},
						{
							"name": "VerificationItemUsageType"
						},
						{
							"name": "VerificationLevel"
						},
						{
							"name": "VerificationSkippedReason"
						},
						{
							"name": "VerificationStatus"
						},
						{
							"name": "VerificationType"
						},
						{
							"name": "VerReqName"
						},
						{
							"name": "VerReqUsageName"
						},
						{
							"name": "WaiverType"
						},
						{
							"name": "WebAddressType"
						},
						{
							"name": "WorkAllocationFunction"
						},
						{
							"name": "WorkflowDeadlineType"
						},
						{
							"name": "WorkflowHistoryEvent"
						},
						{
							"name": "WorkQueueSubsOrgObjType"
						},
						{
							"name": "XSLTemplateType"
						}
					],
					"scriptLines": [
						"source(output(",
						"          TABLENAME as string,",
						"          CODE as string,",
						"          DESCRIPTION as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> vwCodeTables",
						"vwCodeTables filter(TABLENAME=='ActionPageNameCode') ~> ActionPageNameCode",
						"vwCodeTables filter(TABLENAME=='ActivityCategory') ~> ActivityCategory",
						"vwCodeTables filter(TABLENAME=='AddressCountry') ~> AddressCountry",
						"vwCodeTables filter(TABLENAME=='AddressLayoutType') ~> AddressLayoutType",
						"vwCodeTables filter(TABLENAME=='AddressState') ~> AddressState",
						"vwCodeTables filter(TABLENAME=='AddressType') ~> AddressType",
						"vwCodeTables filter(TABLENAME=='AddressUSCounty') ~> AddressUSCounty",
						"vwCodeTables filter(TABLENAME=='AdviceParameterType') ~> AdviceParameterType",
						"vwCodeTables filter(TABLENAME=='AESShareSetStatus') ~> AESShareSetStatus",
						"vwCodeTables filter(TABLENAME=='AESShareSetType') ~> AESShareSetType",
						"vwCodeTables filter(TABLENAME=='AllocationStrategyCode') ~> AllocationStrategyCode",
						"vwCodeTables filter(TABLENAME=='AlternateNameType') ~> AlternateNameType",
						"vwCodeTables filter(TABLENAME=='ApplicantRole') ~> ApplicantRole",
						"vwCodeTables filter(TABLENAME=='ApplicantStatus') ~> ApplicantStatus",
						"vwCodeTables filter(TABLENAME=='APPLICATION_CODE') ~> APPLICATIONCODE",
						"vwCodeTables filter(TABLENAME=='ApplicationCaseStatus') ~> ApplicationCaseStatus",
						"vwCodeTables filter(TABLENAME=='ApplicationChannel') ~> ApplicationChannel",
						"vwCodeTables filter(TABLENAME=='ApplicationFiledByType') ~> ApplicationFiledByType",
						"vwCodeTables filter(TABLENAME=='ApplicationMethod') ~> ApplicationMethod",
						"vwCodeTables filter(TABLENAME=='ApplicationReassignReason') ~> ApplicationReassignReason",
						"vwCodeTables filter(TABLENAME=='ApplicationRoleStatus') ~> ApplicationRoleStatus",
						"vwCodeTables filter(TABLENAME=='ApplicationRoleType') ~> ApplicationRoleType",
						"vwCodeTables filter(TABLENAME=='ApplicationStatus') ~> ApplicationStatus",
						"vwCodeTables filter(TABLENAME=='ApplicationType') ~> ApplicationType",
						"vwCodeTables filter(TABLENAME=='AssessmentDateListType') ~> AssessmentDateListType",
						"vwCodeTables filter(TABLENAME=='BranchOfService') ~> BranchOfService",
						"vwCodeTables filter(TABLENAME=='CaseAssessmentDetReason') ~> CaseAssessmentDetReason",
						"vwCodeTables filter(TABLENAME=='CaseCatTypeCode') ~> CaseCatTypeCode",
						"vwCodeTables filter(TABLENAME=='CaseClassification') ~> CaseClassification",
						"vwCodeTables filter(TABLENAME=='CaseDecisionStatusCode') ~> CaseDecisionStatusCode",
						"vwCodeTables filter(TABLENAME=='CaseDeterminationStatus') ~> CaseDeterminationStatus",
						"vwCodeTables filter(TABLENAME=='CaseDeterminationType') ~> CaseDeterminationType",
						"vwCodeTables filter(TABLENAME=='CaseDetEvidenceUsed') ~> CaseDetEvidenceUsed",
						"vwCodeTables filter(TABLENAME=='CaseObjective') ~> CaseObjective",
						"vwCodeTables filter(TABLENAME=='CaseOutcome') ~> CaseOutcome",
						"vwCodeTables filter(TABLENAME=='CaseParticipantRoleType') ~> CaseParticipantRoleType",
						"vwCodeTables filter(TABLENAME=='CasePriority') ~> CasePriority",
						"vwCodeTables filter(TABLENAME=='CaseSnapshoDetReason') ~> CaseSnapshoDetReason",
						"vwCodeTables filter(TABLENAME=='CaseStatus') ~> CaseStatus",
						"vwCodeTables filter(TABLENAME=='CaseTypeCode') ~> CaseTypeCode",
						"vwCodeTables filter(TABLENAME=='CategoryActionState') ~> CategoryActionState",
						"vwCodeTables filter(TABLENAME=='CategoryName') ~> CategoryName",
						"vwCodeTables filter(TABLENAME=='CategoryTitle') ~> CategoryTitle",
						"vwCodeTables filter(TABLENAME=='CIPreferredContact') ~> CIPreferredContact",
						"vwCodeTables filter(TABLENAME=='CIReferralResason') ~> CIReferralResason",
						"vwCodeTables filter(TABLENAME=='ClassDivisionType') ~> ClassDivisionType",
						"vwCodeTables filter(TABLENAME=='ClientRegistration') ~> ClientRegistration",
						"vwCodeTables filter(TABLENAME=='CommunicationMethod') ~> CommunicationMethod",
						"vwCodeTables filter(TABLENAME=='CommunicationType') ~> CommunicationType",
						"vwCodeTables filter(TABLENAME=='CompanyType') ~> CompanyType",
						"vwCodeTables filter(TABLENAME=='ConcernRoleAlternateID') ~> ConcernRoleAlternateID",
						"vwCodeTables filter(TABLENAME=='ConcernRoleStatus') ~> ConcernRoleStatus",
						"vwCodeTables filter(TABLENAME=='ConcernRoleType') ~> ConcernRoleType",
						"vwCodeTables filter(TABLENAME=='ConstraintType') ~> ConstraintType",
						"vwCodeTables filter(TABLENAME=='ContractType') ~> ContractType",
						"vwCodeTables filter(TABLENAME=='CopayCap') ~> CopayCap",
						"vwCodeTables filter(TABLENAME=='Country') ~> Country",
						"vwCodeTables filter(TABLENAME=='CountyDetailsLinkedType') ~> CountyDetailsLinkedType",
						"vwCodeTables filter(TABLENAME=='CoverageEndReason') ~> CoverageEndReason",
						"vwCodeTables filter(TABLENAME=='CoverageType') ~> CoverageType",
						"vwCodeTables filter(TABLENAME=='CreoleValueState') ~> CreoleValueState",
						"vwCodeTables filter(TABLENAME=='Currency') ~> Currency",
						"vwCodeTables filter(TABLENAME=='DADisabilityConditionType') ~> DADisabilityConditionType",
						"vwCodeTables filter(TABLENAME=='DeterminationCompStrategy') ~> DeterminationCompStrategy",
						"vwCodeTables filter(TABLENAME=='DetIntSummarizerStrategy') ~> DetIntSummarizerStrategy",
						"vwCodeTables filter(TABLENAME=='DETVersionStatus') ~> DETVersionStatus",
						"vwCodeTables filter(TABLENAME=='EmailType') ~> EmailType",
						"vwCodeTables filter(TABLENAME=='EthnicOrigin') ~> EthnicOrigin",
						"vwCodeTables filter(TABLENAME=='EvidenceChangeReason') ~> EvidenceChangeReason",
						"vwCodeTables filter(TABLENAME=='EvidenceDescriptorStatus') ~> EvidenceDescriptorStatus",
						"vwCodeTables filter(TABLENAME=='EvidenceType') ~> EvidenceType",
						"vwCodeTables filter(TABLENAME=='EvMaintenancePattern') ~> EvMaintenancePattern",
						"vwCodeTables filter(TABLENAME=='ExpectedLengthOfStay') ~> ExpectedLengthOfStay",
						"vwCodeTables filter(TABLENAME=='ExpiryDateFrom') ~> ExpiryDateFrom",
						"vwCodeTables filter(TABLENAME=='FrequencyCode') ~> FrequencyCode",
						"vwCodeTables filter(TABLENAME=='Gender') ~> Gender",
						"vwCodeTables filter(TABLENAME=='GrantorType') ~> GrantorType",
						"vwCodeTables filter(TABLENAME=='IndustryType') ~> IndustryType",
						"vwCodeTables filter(TABLENAME=='IntakeClientType') ~> IntakeClientType",
						"vwCodeTables filter(TABLENAME=='IntakeProcessDefntnState') ~> IntakeProcessDefntnState",
						"vwCodeTables filter(TABLENAME=='IntakeProgApplDenyReason') ~> IntakeProgApplDenyReason",
						"vwCodeTables filter(TABLENAME=='IntakeProgApplStatus') ~> IntakeProgApplStatus",
						"vwCodeTables filter(TABLENAME=='Language') ~> Language",
						"vwCodeTables filter(TABLENAME=='LevelOfCareType') ~> LevelOfCareType",
						"vwCodeTables filter(TABLENAME=='LiabilityReassessmentType') ~> LiabilityReassessmentType",
						"vwCodeTables filter(TABLENAME=='Locale') ~> Locale",
						"vwCodeTables filter(TABLENAME=='LocationStatus') ~> LocationStatus",
						"vwCodeTables filter(TABLENAME=='LocationType') ~> LocationType",
						"vwCodeTables filter(TABLENAME=='MaritalStatus') ~> MaritalStatus",
						"vwCodeTables filter(TABLENAME=='MedicalInstitutionType') ~> MedicalInstitutionType",
						"vwCodeTables filter(TABLENAME=='MethodOfApplication') ~> MethodOfApplication",
						"vwCodeTables filter(TABLENAME=='MethodOfDelivery') ~> MethodOfDelivery",
						"vwCodeTables filter(TABLENAME=='MilitaryRank') ~> MilitaryRank",
						"vwCodeTables filter(TABLENAME=='Nationality') ~> Nationality",
						"vwCodeTables filter(TABLENAME=='OccupationType') ~> OccupationType",
						"vwCodeTables filter(TABLENAME=='OutcomeAchieved') ~> OutcomeAchieved",
						"vwCodeTables filter(TABLENAME=='OverUnderPmntProcessing') ~> OverUnderPmntProcessing",
						"vwCodeTables filter(TABLENAME=='ParticipantRoleEndReason') ~> ParticipantRoleEndReason",
						"vwCodeTables filter(TABLENAME=='PersonTitle') ~> PersonTitle",
						"vwCodeTables filter(TABLENAME=='PersonType') ~> PersonType",
						"vwCodeTables filter(TABLENAME=='PhoneType') ~> PhoneType",
						"vwCodeTables filter(TABLENAME=='PlacedByFiledBy') ~> PlacedByFiledBy",
						"vwCodeTables filter(TABLENAME=='PlacedByType') ~> PlacedByType",
						"vwCodeTables filter(TABLENAME=='POIProgram') ~> POIProgram",
						"vwCodeTables filter(TABLENAME=='PreferredSEMethod') ~> PreferredSEMethod",
						"vwCodeTables filter(TABLENAME=='ProductAdminCategory') ~> ProductAdminCategory",
						"vwCodeTables filter(TABLENAME=='ProductCategory') ~> ProductCategory",
						"vwCodeTables filter(TABLENAME=='ProductCoverPeriod') ~> ProductCoverPeriod",
						"vwCodeTables filter(TABLENAME=='ProductDeliveryCategory') ~> ProductDeliveryCategory",
						"vwCodeTables filter(TABLENAME=='ProductName') ~> ProductName",
						"vwCodeTables filter(TABLENAME=='ProductReassessmentStrat') ~> ProductReassessmentStrat",
						"vwCodeTables filter(TABLENAME=='ProductRoundType') ~> ProductRoundType",
						"vwCodeTables filter(TABLENAME=='ProductType') ~> ProductType",
						"vwCodeTables filter(TABLENAME=='ProgAppStatusTransReason') ~> ProgAppStatusTransReason",
						"vwCodeTables filter(TABLENAME=='ProgGrpDeterminationType') ~> ProgGrpDeterminationType",
						"vwCodeTables filter(TABLENAME=='ProgramActionType') ~> ProgramActionType",
						"vwCodeTables filter(TABLENAME=='ProgramName') ~> ProgramName",
						"vwCodeTables filter(TABLENAME=='ProgramStatus') ~> ProgramStatus",
						"vwCodeTables filter(TABLENAME=='ProgramStatusReason') ~> ProgramStatusReason",
						"vwCodeTables filter(TABLENAME=='ProgramType') ~> ProgramType",
						"vwCodeTables filter(TABLENAME=='ProgRecEligibilityStatus') ~> ProgRecEligibilityStatus",
						"vwCodeTables filter(TABLENAME=='ProgRecEligibStartDate') ~> ProgRecEligibStartDate",
						"vwCodeTables filter(TABLENAME=='ProgRecEvidenceUsed') ~> ProgRecEvidenceUsed",
						"vwCodeTables filter(TABLENAME=='ProgRecExecutionStatus') ~> ProgRecExecutionStatus",
						"vwCodeTables filter(TABLENAME=='PropertyCategory') ~> PropertyCategory",
						"vwCodeTables filter(TABLENAME=='PropertyType') ~> PropertyType",
						"vwCodeTables filter(TABLENAME=='ProviderCategory') ~> ProviderCategory",
						"vwCodeTables filter(TABLENAME=='ProviderCategoryEndReason') ~> ProviderCategoryEndReason",
						"vwCodeTables filter(TABLENAME=='ProviderStatus') ~> ProviderStatus",
						"vwCodeTables filter(TABLENAME=='RateCellType') ~> RateCellType",
						"vwCodeTables filter(TABLENAME=='RateColumnType') ~> RateColumnType",
						"vwCodeTables filter(TABLENAME=='RateRowType') ~> RateRowType",
						"vwCodeTables filter(TABLENAME=='RateStatus') ~> RateStatus",
						"vwCodeTables filter(TABLENAME=='RateTableType') ~> RateTableType",
						"vwCodeTables filter(TABLENAME=='RecordStatus') ~> RecordStatus",
						"vwCodeTables filter(TABLENAME=='ReferralSource') ~> ReferralSource",
						"vwCodeTables filter(TABLENAME=='ReimbursementType') ~> ReimbursementType",
						"vwCodeTables filter(TABLENAME=='RelationshipEndReason') ~> RelationshipEndReason",
						"vwCodeTables filter(TABLENAME=='RelationshipTypeCode') ~> RelationshipTypeCode",
						"vwCodeTables filter(TABLENAME=='RepresentativeType') ~> RepresentativeType",
						"vwCodeTables filter(TABLENAME=='ReverificationMode') ~> ReverificationMode",
						"vwCodeTables filter(TABLENAME=='RshipToPolicyholder') ~> RshipToPolicyholder",
						"vwCodeTables filter(TABLENAME=='SDAssessmentMethod') ~> SDAssessmentMethod",
						"vwCodeTables filter(TABLENAME=='SDAssessmentReason') ~> SDAssessmentReason",
						"vwCodeTables filter(TABLENAME=='SDCalculationRule') ~> SDCalculationRule",
						"vwCodeTables filter(TABLENAME=='SDCREOLECaseDetAction') ~> SDCREOLECaseDetAction",
						"vwCodeTables filter(TABLENAME=='SDCREOLECaseDetRecStatus') ~> SDCREOLECaseDetRecStatus",
						"vwCodeTables filter(TABLENAME=='SDCREOLECaseDetStatus') ~> SDCREOLECaseDetStatus",
						"vwCodeTables filter(TABLENAME=='SDIHSCoPayInd') ~> SDIHSCoPayInd",
						"vwCodeTables filter(TABLENAME=='SDMAForcedEligReason') ~> SDMAForcedEligReason",
						"vwCodeTables filter(TABLENAME=='SDMedAidPrgmCatClass') ~> SDMedAidPrgmCatClass",
						"vwCodeTables filter(TABLENAME=='SDPolicyholderRole') ~> SDPolicyholderRole",
						"vwCodeTables filter(TABLENAME=='SDProdHeirarchyCat') ~> SDProdHeirarchyCat",
						"vwCodeTables filter(TABLENAME=='SDRecertificationStatus') ~> SDRecertificationStatus",
						"vwCodeTables filter(TABLENAME=='SDRegionApplicationType') ~> SDRegionApplicationType",
						"vwCodeTables filter(TABLENAME=='SDSuspensionReason') ~> SDSuspensionReason",
						"vwCodeTables filter(TABLENAME=='SDTribalEnrollmentInd') ~> SDTribalEnrollmentInd",
						"vwCodeTables filter(TABLENAME=='SDTribeCode') ~> SDTribeCode",
						"vwCodeTables filter(TABLENAME=='SecretQuestionType') ~> SecretQuestionType",
						"vwCodeTables filter(TABLENAME=='Sensitivity') ~> Sensitivity",
						"vwCodeTables filter(TABLENAME=='ServCessReason') ~> ServCessReason",
						"vwCodeTables filter(TABLENAME=='ServiceType') ~> ServiceType",
						"vwCodeTables filter(TABLENAME=='SourceOfFund') ~> SourceOfFund",
						"vwCodeTables filter(TABLENAME=='SpecialInterest') ~> SpecialInterest",
						"vwCodeTables filter(TABLENAME=='StateCodes') ~> StateCodes",
						"vwCodeTables filter(TABLENAME=='TargetItemType') ~> TargetItemType",
						"vwCodeTables filter(TABLENAME=='TaskCategoryCode') ~> TaskCategoryCode",
						"vwCodeTables filter(TABLENAME=='TaskChangeType') ~> TaskChangeType",
						"vwCodeTables filter(TABLENAME=='TaskPriority') ~> TaskPriority",
						"vwCodeTables filter(TABLENAME=='TaskStatus') ~> TaskStatus",
						"vwCodeTables filter(TABLENAME=='TemplateIDCode') ~> TemplateIDCode",
						"vwCodeTables filter(TABLENAME=='ThirdPartyProductType') ~> ThirdPartyProductType",
						"vwCodeTables filter(TABLENAME=='TrustCategory') ~> TrustCategory",
						"vwCodeTables filter(TABLENAME=='TrusteeType') ~> TrusteeType",
						"vwCodeTables filter(TABLENAME=='TrustIncomeType') ~> TrustIncomeType",
						"vwCodeTables filter(TABLENAME=='TrustType') ~> TrustType",
						"vwCodeTables filter(TABLENAME=='UndueHardshipReason') ~> UndueHardshipReason",
						"vwCodeTables filter(TABLENAME=='UnearnedIncomeType') ~> UnearnedIncomeType",
						"vwCodeTables filter(TABLENAME=='UnearnedRentIncExpType') ~> UnearnedRentIncExpType",
						"vwCodeTables filter(TABLENAME=='URATypeAction') ~> URATypeAction",
						"vwCodeTables filter(TABLENAME=='UserGrade') ~> UserGrade",
						"vwCodeTables filter(TABLENAME=='UserRecentActionType') ~> UserRecentActionType",
						"vwCodeTables filter(TABLENAME=='UserSearchType') ~> UserSearchType",
						"vwCodeTables filter(TABLENAME=='UtahCounties') ~> UtahCounties",
						"vwCodeTables filter(TABLENAME=='UtilityExpenseType') ~> UtilityExpenseType",
						"vwCodeTables filter(TABLENAME=='UtilityType') ~> UtilityType",
						"vwCodeTables filter(TABLENAME=='VehicleMake') ~> VehicleMake",
						"vwCodeTables filter(TABLENAME=='VehicleUsageCode') ~> VehicleUsageCode",
						"vwCodeTables filter(TABLENAME=='VerifiableItemName') ~> VerifiableItemName",
						"vwCodeTables filter(TABLENAME=='VerificationCatName') ~> VerificationCatName",
						"vwCodeTables filter(TABLENAME=='VerificationDueDateFrom') ~> VerificationDueDateFrom",
						"vwCodeTables filter(TABLENAME=='VerificationItemName') ~> VerificationItemName",
						"vwCodeTables filter(TABLENAME=='VerificationItemType') ~> VerificationItemType",
						"vwCodeTables filter(TABLENAME=='VerificationItemUsageType') ~> VerificationItemUsageType",
						"vwCodeTables filter(TABLENAME=='VerificationLevel') ~> VerificationLevel",
						"vwCodeTables filter(TABLENAME=='VerificationSkippedReason') ~> VerificationSkippedReason",
						"vwCodeTables filter(TABLENAME=='VerificationStatus') ~> VerificationStatus",
						"vwCodeTables filter(TABLENAME=='VerificationType') ~> VerificationType",
						"vwCodeTables filter(TABLENAME=='VerReqName') ~> VerReqName",
						"vwCodeTables filter(TABLENAME=='VerReqUsageName') ~> VerReqUsageName",
						"vwCodeTables filter(TABLENAME=='WaiverType') ~> WaiverType",
						"vwCodeTables filter(TABLENAME=='WebAddressType') ~> WebAddressType",
						"vwCodeTables filter(TABLENAME=='WorkAllocationFunction') ~> WorkAllocationFunction",
						"vwCodeTables filter(TABLENAME=='WorkflowDeadlineType') ~> WorkflowDeadlineType",
						"vwCodeTables filter(TABLENAME=='WorkflowHistoryEvent') ~> WorkflowHistoryEvent",
						"vwCodeTables filter(TABLENAME=='WorkQueueSubsOrgObjType') ~> WorkQueueSubsOrgObjType",
						"vwCodeTables filter(TABLENAME=='XSLTemplateType') ~> XSLTemplateType",
						"ActionPageNameCode sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          Column_1 as string,",
						"          Column_2 as string,",
						"          Column_3 as string,",
						"          Column_4 as string,",
						"          Column_5 as string,",
						"          Column_6 as string",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> tgtDummyFile"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/df_OrganizationalUnit')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Organizational Unit Dimension",
				"folder": {
					"name": "Dimensions"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "OrganizationUnit",
								"type": "DatasetReference"
							},
							"name": "srcOrganizationalUnit"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "DimensionTargetTesting",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [],
					"scriptLines": [
						"source(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> srcOrganizationalUnit",
						"srcOrganizationalUnit sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          Column_1 as string,",
						"          Column_2 as string,",
						"          Column_3 as string,",
						"          Column_4 as string,",
						"          Column_5 as string,",
						"          Column_6 as string",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> sink1"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/df_Person')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Final df POCs"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "vwCodeTable",
								"type": "DatasetReference"
							},
							"name": "vwCodeTables"
						},
						{
							"dataset": {
								"referenceName": "Person",
								"type": "DatasetReference"
							},
							"name": "srcPerson"
						},
						{
							"dataset": {
								"referenceName": "AlternateName",
								"type": "DatasetReference"
							},
							"name": "srcAlternateName"
						},
						{
							"dataset": {
								"referenceName": "ConcernRole",
								"type": "DatasetReference"
							},
							"name": "srcConcernRole"
						},
						{
							"dataset": {
								"referenceName": "PhoneNumber",
								"type": "DatasetReference"
							},
							"name": "srcPhoneNumber"
						},
						{
							"dataset": {
								"referenceName": "Address",
								"type": "DatasetReference"
							},
							"name": "vwAddress"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Dummy1",
								"type": "DatasetReference"
							},
							"name": "DummyFile"
						}
					],
					"transformations": [
						{
							"name": "CaseObjective"
						},
						{
							"name": "CaseStatus"
						},
						{
							"name": "CasePriority"
						},
						{
							"name": "CaseOutcome"
						},
						{
							"name": "CaseClassification"
						},
						{
							"name": "CaseTypeCode"
						}
					],
					"scriptLines": [
						"source(output(",
						"          TABLENAME as string,",
						"          CODE as string,",
						"          DESCRIPTION as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> vwCodeTables",
						"source(output(",
						"          CONCERNROLEID as long,",
						"          PERSONBIRTHNAME as string,",
						"          DATEOFBIRTH as date,",
						"          DATEOFDEATH as date,",
						"          GENDER as string,",
						"          SPECIALINTERESTCODE as string,",
						"          LASTWRITTEN as timestamp,",
						"          UPPERPERSONBIRTHNAME as string,",
						"          UPPERMOTHERBIRTHSURNAME as string,",
						"          RACE as string,",
						"          INDIGENOUSGROUPCODE as string,",
						"          INDIGENOUSPERSONIND as string,",
						"          VERSIONNO as integer,",
						"          PRIMARYALTERNATENAMEID as long,",
						"          ETHNICORIGINCODE as string,",
						"          PAYMENTFREQUENCY as string,",
						"          NEXTPAYMENTDATE as date,",
						"          CURRENCYTYPE as string,",
						"          METHODOFPMTCODE as string,",
						"          DATEOFBIRTHVERIND as string,",
						"          DATEOFDEATHVERIND as string,",
						"          PRIMARYALTERNATEID as string,",
						"          COUNTRYOFBIRTH as string,",
						"          PLACEOFBIRTH as string,",
						"          PINNUMBER as string,",
						"          MARITALSTATUSCODE as string,",
						"          NATIONALITYCODE as string,",
						"          RESIDENCYABROADIND as string,",
						"          MOTHERBIRTHSURNAME as string,",
						"          COMMENTS as string,",
						"          TYPE as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> srcPerson",
						"source(output(",
						"          ALTERNATENAMEID as long,",
						"          CONCERNROLEID as long,",
						"          TITLE as string,",
						"          FIRSTFORENAME as string,",
						"          OTHERFORENAME as string,",
						"          SURNAME as string,",
						"          UPPERFIRSTFORENAME as string,",
						"          UPPERSURNAME as string,",
						"          PHONETICENCODING as string,",
						"          VERSIONNO as integer,",
						"          LASTWRITTEN as timestamp,",
						"          NAMESUFFIX as string,",
						"          NAMETYPE as string,",
						"          NAMESTATUS as string,",
						"          FULLNAME as string,",
						"          COMMENTS as string,",
						"          INITIALS as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> srcAlternateName",
						"source(output(",
						"          CONCERNID as long,",
						"          CONCERNROLEID as long,",
						"          CONCERNROLETYPE as string,",
						"          CREATIONDATE as date,",
						"          REGISTRATIONDATE as date,",
						"          STARTDATE as date,",
						"          LASTWRITTEN as timestamp,",
						"          SENSITIVITY as string,",
						"          PREFCOMMMETHOD as string,",
						"          PREFCOMMFROMDATE as date,",
						"          PREFCOMMTODATE as date,",
						"          PRIMARYWEBADDRESSID as long,",
						"          VERSIONNO as integer,",
						"          PRIMARYPHONENUMBERID as long,",
						"          PRIMARYEMAILADDRESSID as long,",
						"          PRIMARYBANKACCOUNTID as long,",
						"          REGUSERNAME as string,",
						"          PREFPUBLICOFFICEID as long,",
						"          PREFERREDLANGUAGE as string,",
						"          ENDDATE as date,",
						"          STATUSCODE as string,",
						"          CONCERNROLENAME as string,",
						"          PRIMARYADDRESSID as long,",
						"          PRIMARYALTERNATEID as string,",
						"          COMMENTS as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> srcConcernRole",
						"source(output(",
						"          PHONENUMBERID as long,",
						"          PHONECOUNTRYCODE as string,",
						"          PHONEAREACODE as string,",
						"          PHONENUMBER as string,",
						"          PHONEEXTENSION as string,",
						"          STATUSCODE as string,",
						"          COMMENTS as string,",
						"          VERSIONNO as integer,",
						"          LASTWRITTEN as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> srcPhoneNumber",
						"source(output(",
						"          ADDRESSID as long,",
						"          ADDRESS1 as string,",
						"          ADDRESS2 as string,",
						"          ADDRESS3 as string,",
						"          CITY as string,",
						"          STATE as string,",
						"          USCOUNTY as string,",
						"          ZIP as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> vwAddress",
						"vwCodeTables filter(TABLENAME=='CaseObjective') ~> CaseObjective",
						"vwCodeTables filter(TABLENAME=='CaseStatus') ~> CaseStatus",
						"vwCodeTables filter(TABLENAME=='CasePriority') ~> CasePriority",
						"vwCodeTables filter(TABLENAME=='CaseOutcome') ~> CaseOutcome",
						"vwCodeTables filter(TABLENAME=='CaseClassification') ~> CaseClassification",
						"vwCodeTables filter(TABLENAME=='CaseTypeCode') ~> CaseTypeCode",
						"CaseObjective sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          Column_1 as string",
						"     ),",
						"     partitionFileNames:['CaseHeaderPOC'],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> DummyFile"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/df_RptToStage')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Staging"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "db2DynamicSource",
								"type": "DatasetReference"
							},
							"name": "RptDB"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "stgDynamicTarget",
								"type": "DatasetReference"
							},
							"name": "StgDB"
						}
					],
					"transformations": [
						{
							"name": "Upsert"
						}
					],
					"scriptLines": [
						"parameters{",
						"     TableName as string,",
						"     SchemaName as string,",
						"     UniqueID as string",
						"}",
						"source(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     waterMarkColumn: 'LastWritten',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table',",
						"     mode: 'read') ~> RptDB",
						"RptDB alterRow(upsertIf(true())) ~> Upsert",
						"Upsert sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:[($UniqueID)],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> StgDB"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/df_SCD1_Example')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Facts"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "reportingSalesOrderHeader",
								"type": "DatasetReference"
							},
							"name": "reportingSalesOrderHeader"
						},
						{
							"dataset": {
								"referenceName": "DimAddress",
								"type": "DatasetReference"
							},
							"name": "DimAddress"
						},
						{
							"dataset": {
								"referenceName": "DimCustomer",
								"type": "DatasetReference"
							},
							"name": "DimCustomer"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "target_SalesOrderHeader_wDate",
								"type": "DatasetReference"
							},
							"name": "targetSalesOrders"
						}
					],
					"transformations": [
						{
							"name": "SelectColumnsWShipToDescription"
						},
						{
							"name": "LkpShipToAddress"
						},
						{
							"name": "Upsert"
						},
						{
							"name": "LkpCustomerDescip"
						},
						{
							"name": "SelectColumnWCustDescrip"
						},
						{
							"name": "LkpBillToAddressDescr"
						},
						{
							"name": "SelectColumnsWBillToDescr"
						}
					],
					"scriptLines": [
						"source(output(",
						"          SalesOrderID as integer,",
						"          RevisionNumber as integer,",
						"          OrderDate as timestamp,",
						"          DueDate as timestamp,",
						"          ShipDate as timestamp,",
						"          Status as integer,",
						"          OnlineOrderFlag as boolean,",
						"          SalesOrderNumber as string,",
						"          PurchaseOrderNumber as string,",
						"          AccountNumber as string,",
						"          CustomerID as integer,",
						"          ShipToAddressID as integer,",
						"          BillToAddressID as integer,",
						"          ShipMethod as string,",
						"          CreditCardApprovalCode as string,",
						"          SubTotal as decimal(19,4),",
						"          TaxAmt as decimal(19,4),",
						"          Freight as decimal(19,4),",
						"          TotalDue as decimal(19,4),",
						"          Comment as string,",
						"          rowguid as string,",
						"          ModifiedDate as timestamp",
						"     ),",
						"     allowSchemaDrift: false,",
						"     validateSchema: false,",
						"     waterMarkColumn: 'ModifiedDate',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table',",
						"     mode: 'read') ~> reportingSalesOrderHeader",
						"source(output(",
						"          AddressID as integer,",
						"          AddressLine1 as string,",
						"          AddressLine2 as string,",
						"          City as string,",
						"          StateProvince as string,",
						"          CountryRegion as string,",
						"          PostalCode as string,",
						"          rowguid as string,",
						"          ModifiedDate as timestamp",
						"     ),",
						"     allowSchemaDrift: false,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> DimAddress",
						"source(output(",
						"          CustomerID as integer,",
						"          NameStyle as boolean,",
						"          Title as string,",
						"          FirstName as string,",
						"          MiddleName as string,",
						"          LastName as string,",
						"          Suffix as string,",
						"          CompanyName as string,",
						"          SalesPerson as string,",
						"          EmailAddress as string,",
						"          Phone as string,",
						"          PasswordHash as string,",
						"          PasswordSalt as string,",
						"          rowguid as string,",
						"          ModifiedDate as timestamp",
						"     ),",
						"     allowSchemaDrift: false,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> DimCustomer",
						"LkpShipToAddress select(mapColumn(",
						"          SalesOrderID,",
						"          OrderDate,",
						"          Status,",
						"          SalesOrderNumber,",
						"          PurchaseOrderNumber,",
						"          AccountNumber,",
						"          ShipMethod,",
						"          SubTotal,",
						"          TaxAmt,",
						"          Freight,",
						"          TotalDue,",
						"          ModifiedDate = reportingSalesOrderHeader@ModifiedDate,",
						"          ShipToAddressDesscription = AddressLine1,",
						"          CustomerID,",
						"          BillToAddressID",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumnsWShipToDescription",
						"reportingSalesOrderHeader, DimAddress lookup(ShipToAddressID == AddressID,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LkpShipToAddress",
						"SelectColumnsWBillToDescr alterRow(upsertIf(true())) ~> Upsert",
						"SelectColumnsWShipToDescription, DimCustomer lookup(SelectColumnsWShipToDescription@CustomerID == DimCustomer@CustomerID,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LkpCustomerDescip",
						"LkpCustomerDescip select(mapColumn(",
						"          SalesOrderID,",
						"          OrderDate,",
						"          Status,",
						"          SalesOrderNumber,",
						"          PurchaseOrderNumber,",
						"          AccountNumber,",
						"          ShipMethod,",
						"          SubTotal,",
						"          TaxAmt,",
						"          Freight,",
						"          TotalDue,",
						"          ModifiedDate = SelectColumnsWShipToDescription@ModifiedDate,",
						"          ShipToAddressDesscription,",
						"          CustomerDescription = CompanyName,",
						"          ModifiedDate = DimCustomer@ModifiedDate,",
						"          BillToAddressID",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumnWCustDescrip",
						"SelectColumnWCustDescrip, DimAddress lookup(BillToAddressID == AddressID,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LkpBillToAddressDescr",
						"LkpBillToAddressDescr select(mapColumn(",
						"          SalesOrderID,",
						"          OrderDate,",
						"          Status,",
						"          SalesOrderNumber,",
						"          PurchaseOrderNumber,",
						"          AccountNumber,",
						"          ShipMethod,",
						"          SubTotal,",
						"          TaxAmt,",
						"          Freight,",
						"          TotalDue,",
						"          ModifiedDate = SelectColumnWCustDescrip@ModifiedDate,",
						"          ShipToAddressDesscription,",
						"          BillToAddressDesciption = AddressLine1,",
						"          CustomerDescription",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumnsWBillToDescr",
						"Upsert sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          SalesOrderID as integer,",
						"          OrderDate as timestamp,",
						"          Status as integer,",
						"          SalesOrderNumber as string,",
						"          PurchaseOrderNumber as string,",
						"          AccountNumber as string,",
						"          CustomerDescription as string,",
						"          ShipToAddressDescription as string,",
						"          BillToAddressDesciption as string,",
						"          ShipMethod as string,",
						"          SubTotal as decimal(19,4),",
						"          TaxAmt as decimal(19,4),",
						"          Freight as decimal(19,4),",
						"          TotalDue as decimal(19,4),",
						"          ModifiedDate as timestamp,",
						"          CreatedDate as timestamp",
						"     ),",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['SalesOrderID'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          SalesOrderID,",
						"          OrderDate,",
						"          Status,",
						"          SalesOrderNumber,",
						"          PurchaseOrderNumber,",
						"          AccountNumber,",
						"          ShipMethod,",
						"          SubTotal,",
						"          TaxAmt,",
						"          Freight,",
						"          TotalDue,",
						"          ModifiedDate,",
						"          ShipToAddressDescription = ShipToAddressDesscription,",
						"          CustomerDescription,",
						"          BillToAddressDesciption",
						"     )) ~> targetSalesOrders"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/df_SCD1_Example_NoCDC')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "Facts"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "reportingSalesOrderHeader",
								"type": "DatasetReference"
							},
							"name": "reportingSalesOrderHeader"
						},
						{
							"dataset": {
								"referenceName": "DimAddress",
								"type": "DatasetReference"
							},
							"name": "DimAddress"
						},
						{
							"dataset": {
								"referenceName": "DimCustomer",
								"type": "DatasetReference"
							},
							"name": "DimCustomer"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "target_SalesOrderHeader_wDate",
								"type": "DatasetReference"
							},
							"name": "targetSalesOrders"
						}
					],
					"transformations": [
						{
							"name": "SelectColumnsWShipToDescription"
						},
						{
							"name": "LkpShipToAddress"
						},
						{
							"name": "Upsert"
						},
						{
							"name": "LkpCustomerDescip"
						},
						{
							"name": "SelectColumnWCustDescrip"
						},
						{
							"name": "LkpBillToAddressDescr"
						},
						{
							"name": "SelectColumnsWBillToDescr"
						}
					],
					"scriptLines": [
						"source(output(",
						"          SalesOrderID as integer,",
						"          RevisionNumber as integer,",
						"          OrderDate as timestamp,",
						"          DueDate as timestamp,",
						"          ShipDate as timestamp,",
						"          Status as integer,",
						"          OnlineOrderFlag as boolean,",
						"          SalesOrderNumber as string,",
						"          PurchaseOrderNumber as string,",
						"          AccountNumber as string,",
						"          CustomerID as integer,",
						"          ShipToAddressID as integer,",
						"          BillToAddressID as integer,",
						"          ShipMethod as string,",
						"          CreditCardApprovalCode as string,",
						"          SubTotal as decimal(19,4),",
						"          TaxAmt as decimal(19,4),",
						"          Freight as decimal(19,4),",
						"          TotalDue as decimal(19,4),",
						"          Comment as string,",
						"          rowguid as string,",
						"          ModifiedDate as timestamp",
						"     ),",
						"     allowSchemaDrift: false,",
						"     validateSchema: false,",
						"     waterMarkColumn: 'ModifiedDate',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table',",
						"     mode: 'read') ~> reportingSalesOrderHeader",
						"source(output(",
						"          AddressID as integer,",
						"          AddressLine1 as string,",
						"          AddressLine2 as string,",
						"          City as string,",
						"          StateProvince as string,",
						"          CountryRegion as string,",
						"          PostalCode as string,",
						"          rowguid as string,",
						"          ModifiedDate as timestamp",
						"     ),",
						"     allowSchemaDrift: false,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> DimAddress",
						"source(output(",
						"          CustomerID as integer,",
						"          NameStyle as boolean,",
						"          Title as string,",
						"          FirstName as string,",
						"          MiddleName as string,",
						"          LastName as string,",
						"          Suffix as string,",
						"          CompanyName as string,",
						"          SalesPerson as string,",
						"          EmailAddress as string,",
						"          Phone as string,",
						"          PasswordHash as string,",
						"          PasswordSalt as string,",
						"          rowguid as string,",
						"          ModifiedDate as timestamp",
						"     ),",
						"     allowSchemaDrift: false,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> DimCustomer",
						"LkpShipToAddress select(mapColumn(",
						"          SalesOrderID,",
						"          OrderDate,",
						"          Status,",
						"          SalesOrderNumber,",
						"          PurchaseOrderNumber,",
						"          AccountNumber,",
						"          ShipMethod,",
						"          SubTotal,",
						"          TaxAmt,",
						"          Freight,",
						"          TotalDue,",
						"          ModifiedDate = reportingSalesOrderHeader@ModifiedDate,",
						"          ShipToAddressDesscription = AddressLine1,",
						"          CustomerID,",
						"          BillToAddressID",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumnsWShipToDescription",
						"reportingSalesOrderHeader, DimAddress lookup(ShipToAddressID == AddressID,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LkpShipToAddress",
						"SelectColumnsWBillToDescr alterRow(upsertIf(true())) ~> Upsert",
						"SelectColumnsWShipToDescription, DimCustomer lookup(SelectColumnsWShipToDescription@CustomerID == DimCustomer@CustomerID,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LkpCustomerDescip",
						"LkpCustomerDescip select(mapColumn(",
						"          SalesOrderID,",
						"          OrderDate,",
						"          Status,",
						"          SalesOrderNumber,",
						"          PurchaseOrderNumber,",
						"          AccountNumber,",
						"          ShipMethod,",
						"          SubTotal,",
						"          TaxAmt,",
						"          Freight,",
						"          TotalDue,",
						"          ModifiedDate = SelectColumnsWShipToDescription@ModifiedDate,",
						"          ShipToAddressDesscription,",
						"          CustomerDescription = CompanyName,",
						"          ModifiedDate = DimCustomer@ModifiedDate,",
						"          BillToAddressID",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumnWCustDescrip",
						"SelectColumnWCustDescrip, DimAddress lookup(BillToAddressID == AddressID,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LkpBillToAddressDescr",
						"LkpBillToAddressDescr select(mapColumn(",
						"          SalesOrderID,",
						"          OrderDate,",
						"          Status,",
						"          SalesOrderNumber,",
						"          PurchaseOrderNumber,",
						"          AccountNumber,",
						"          ShipMethod,",
						"          SubTotal,",
						"          TaxAmt,",
						"          Freight,",
						"          TotalDue,",
						"          ModifiedDate = SelectColumnWCustDescrip@ModifiedDate,",
						"          ShipToAddressDesscription,",
						"          BillToAddressDesciption = AddressLine1,",
						"          CustomerDescription",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumnsWBillToDescr",
						"Upsert sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          SalesOrderID as integer,",
						"          OrderDate as timestamp,",
						"          Status as integer,",
						"          SalesOrderNumber as string,",
						"          PurchaseOrderNumber as string,",
						"          AccountNumber as string,",
						"          CustomerDescription as string,",
						"          ShipToAddressDescription as string,",
						"          BillToAddressDesciption as string,",
						"          ShipMethod as string,",
						"          SubTotal as decimal(19,4),",
						"          TaxAmt as decimal(19,4),",
						"          Freight as decimal(19,4),",
						"          TotalDue as decimal(19,4),",
						"          ModifiedDate as timestamp,",
						"          CreatedDate as timestamp",
						"     ),",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['SalesOrderID'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          SalesOrderID,",
						"          OrderDate,",
						"          Status,",
						"          SalesOrderNumber,",
						"          PurchaseOrderNumber,",
						"          AccountNumber,",
						"          ShipMethod,",
						"          SubTotal,",
						"          TaxAmt,",
						"          Freight,",
						"          TotalDue,",
						"          ModifiedDate,",
						"          ShipToAddressDescription = ShipToAddressDesscription,",
						"          CustomerDescription,",
						"          BillToAddressDesciption",
						"     )) ~> targetSalesOrders"
					]
				}
			},
			"dependsOn": []
		}
	]
}